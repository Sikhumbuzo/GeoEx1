(function(){ovi.provide("nokia.maps.gfx.CanvasPainter");
(function(){var d=nokia.maps.gfx,k=Math,h=k.sqrt,c=k.pow,b=d.Painter,k=d.IDL,g=d.Color,a=k.opcodes,e=k.identifierToAttribute,l=nokia.maps.util.c,l=nokia.maps.util.c,f=b.Yh,p=nokia.maps.gfx.CanvasPainter=new ovi.Class({Extends:nokia.maps.gfx.Painter,updateElement:function(a,b,e){this.dd(a,b,b.ownerDocument);e=f(e);b.style.opacity=b.$n$opacity=e;b.$n$width=a.data[1];b.$n$height=a.data[2]},createElement:function(a,b,e){var c=(b=b||document).createElement("CANVAS");this.dd(a,c,b);e=f(e);c.style.opacity=
c.$n$opacity=e;c.$n$width=a.data[1];c.$n$height=a.data[2];return c},setOpacity:function(a,b){b=f(b);a.style.opacity=a.$n$opacity=b;return this},setScale:function(a,b){a.style.width=a.$n$width*b.x+"px";a.style.height=a.$n$height*b.y+"px"},dd:function(b,f){(!b||!b.data)&&l("CanvasPainter.createElement: Illegal IDL given");var e=b.data,c=-1,d=e[++c],g=e[++c],e=e[++c];d!==a.BEGIN_2D_IMAGE&&l("CanvasPainter.createElement: Illegal opcode in IDL");f.width=g;f.height=e;f.style.width=g+"px";f.style.height=
e+"px";d=f.getContext("2d");d.clearRect(0,0,g,e);this.drawIDLToCanvas(b,d)},drawIDLToCanvas:function(b,f){(!b||!b.data)&&l("CanvasPainter.createElement: Illegal IDL given");var d=b.data,p=-1,k,u,w,v,x,z,A,B,D,E=!1,G,N,Q;k=d[++p];k!==a.BEGIN_2D_IMAGE&&l("CanvasPainter.createElement: Illegal opcode in IDL");++p;++p;++p;f.save();for(f.lineCap="round";k=d[++p];)k===a.BEGIN_PATH?f.beginPath():k===a.MOVE_TO?f.moveTo(d[++p],d[++p]):k===a.LINE_TO?f.lineTo(d[++p],d[++p]):k===a.BEZIER_CURVE_TO?f.bezierCurveTo(d[++p],
d[++p],d[++p],d[++p],d[++p],d[++p]):k===a.FILL?(f.fill(),d[p+1]===a.STROKE&&(p++,E||f.stroke())):k===a.STROKE?(E||f.stroke(),d[p+1]===a.FILL&&(p++,f.fill())):k===a.SET?(z=e[d[++p]],A=d[++p],z==="fillColor"?f.fillStyle=g.getCssRGBA(A):z==="strokeColor"?f.strokeStyle=g.getCssRGBA(A):z==="opacity"?f.globalAlpha=+A:z!=="textBaseline"&&(z==="lineWidth"?E=(f[z]=A)===0:z&&(f[z]=A))):k===a.DRAW_IMAGE?(f.save(),k=d[++p],u=d[++p],w=d[++p],B=d[++p],x=d[++p],v=d[++p],G=d[++p],N=d[++p],Q=d[++p],D=d[++p],z=(u+
B>k.width?k.width-u:B)/B,A=(w+x>k.height?k.height-w:x)/x,D=D.rows,f.transform(D[0][0],D[0][1],D[1][0],D[1][1],D[0][3],D[1][3]),f.drawImage(k,u,w,B*z,x*A,v,G,N*z,Q*A),f.restore()):k===a.SAVE?f.save():k===a.RESTORE?f.restore():(z=k===a.FILL_TEXT,(A=k===a.STROKE_TEXT)||z?(w=d[++p],k=d[++p],u=d[++p],v=d[++p]-k,x=d[++p]-u,B=h(c(v,2)+c(x,2)),v/=B,x/=B,f.save(),f.transform(B*v,B*x,B*-x,B*v,k,u),z&&f.fillText(w,0,0),A&&f.strokeText(w,0,0),f.restore()):k===a.CLOSE_PATH&&f.closePath());f.restore()}});(function(){var a=
document.createElement("CANVAS"),f;if(a&&a.getContext&&(f=a.getContext("2d"))&&typeof f.fillText==="function")b.defaultPainter=p})()})();ovi.provide("nokia.maps.gfx._packaging.package-canvas");})();
