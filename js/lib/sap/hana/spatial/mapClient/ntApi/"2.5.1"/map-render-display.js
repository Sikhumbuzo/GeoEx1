(function(){ovi.provide("nokia.maps.map.provider.IData");ovi.provide("nokia.maps.map.provider.IObjectProvider");ovi.provide("nokia.maps.util.proto");(function(){var d={}.toString,k=nokia.maps.util.proto=function(h,c,b,g){var a=Function(),e,l;a.prototype=c;a=new a;for(e in h)h.hasOwnProperty(e)&&(a[e]=b&&e in c&&d.call(l=h[e])==="[object Object]"?k(l,c[e],b):h[e]);if(b&&!g)for(e in c)if(c.hasOwnProperty(e)&&(l=c[e])===a[e]&&d.call(l)==="[object Object]")a[e]=k(0,l,b);return a}})();ovi.provide("nokia.maps.map.render.p2d.dom._helpers");
(function(d){ovi.extend(d,{geoToScreen:function(d,h){var c=h.geoToPixel(d),b=h.w;c.x-=Math.round(c.x/b)*b;return c}})})(nokia.maps.map.render.p2d.dom._helpers);ovi.provide("nokia.maps.map.render.p2d.dom.ILayer");ovi.provide("nokia.maps.util.Event");(function(d){var k=d.now,d=d.Event=function(d){this.type=""+d;this.timeStamp=k()};ovi.extend(d.prototype,{target:null,defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0}})})(nokia.maps.util);ovi.provide("nokia.maps.util.Cache");
(function(d){function k(a,b,e,c){this.d=a;this.Uc=b;if(this.o!==c)this.o=c;if(e)(e.Ze=this).sc=e}function h(b,e){a.Uc=b;a.o=e===void 0?1:e;return a}function c(a){return a===void 0?1:isNaN(a=+a)||a<0||a===l?d.c():a}var b={},g={},a={},e={},l=1/0;d.Cache=new ovi.Class({initialize:function(a,b,e,d){this.Xo=c(a);if(b)this.ar=b;if(e)this.tt=e;if(d)this.Pe=d;this.H={}},Statics:{DONT:b,NEXT:g,NOT_ENOUGH_SPACE:e,change:h},o:0,change:h,add:function(f,d,m){var l=this.ar,h=this.Pe,y=this.H,s=y[f],u;if(l){if((l=
l(d))===g)return s&&this.remove(f,1),h?h.add(f,d,m):g;if(l===b)return s&&this.remove(f),b;l===a?(d=l.Uc,m=l.o):d=l}if((m=c(m))>this.Xo)return h?h.add(f,d,m):e;if(s)this.o+=m-s.o,s.Uc=d,s.o=m,this.bp(s);else{s=y[f]=this.Oe=new k(f,d,this.Oe,m);if(!this.Bg)this.Bg=s;this.o+=m}for(;this.o>this.Xo;)this.fb((u=this.Bg).d,u),h&&h.add(u.d,u.Uc,u.o)},get:function(a,b){var e=this.H[a],c;e&&(b||this.bp(e));return e?e.Uc:(c=this.Pe)?c.get(a,b):void 0},remove:function(a,b){var e=this.H[a],c,d;e&&this.fb(a,e);
if(!b&&(c=this.Pe))d=c.remove(a,b);return e?e.Uc:d},removeAll:function(a){var b=this.H,e,c;for(e in b)b.hasOwnProperty(e)&&!e.indexOf(a)&&this.fb(e,b[e]);(c=this.Pe)&&c.removeAll(a)},destroy:function(){var a=this.H,b,e;for(e in a)(b=a[e]).sc=0,b.Ze=0;this.Bg=this.Oe=0;this.Pe&&this.Pe.destroy()},fb:function(a,b,e){var c=b.Ze,d=b.sc,g;c?d?(c.sc=d).Ze=c:(this.Bg=c).sc=void 0:(this.Oe=d)?d.Ze=void 0:this.Bg=void 0;if(!e)delete this.H[a],this.o-=b.o,(g=this.tt)&&g(b.Uc);return b.Uc},bp:function(a){var b=
this.Oe;if((b=this.Oe)!==a){this.fb(a.d,a,1);if(b)(b.Ze=a).sc=b;(this.Oe=a).Ze=void 0}}});k.prototype.o=1})(nokia.maps.util);ovi.provide("nokia.maps.util.Arrows");(function(d){var k=nokia.maps.gfx.Color,h={color:1,width:1,length:1,frequency:1};d.Arrows=new ovi.Class({width:1.2,length:1.6,frequency:5,color:"#FFFC",initialize:function(c){var b,g,a=d.c;if(typeof c==="object")for(b in h)h.hasOwnProperty(b)&&b in c&&(g=c[b],b==="color"?k.parseCss(g)===null&&a(b):g<=0&&a(b),this[b]=c[b])}})})(nokia.maps.util);
ovi.provide("nokia.maps.map.provider.Tile");(function(){var d=nokia.maps,k=d.dom.importNode,h=d.dom.cloneNode;ovi.extend((nokia.maps.map.provider.Tile=function(c,b,d){this.id=c;if(b)(this.data=b).style.position="absolute";this.Ph=(this.k=d)?d.getInvalidationMark():void 0}).prototype,{Ph:-1/0,Bj:1,state:void 0,getInvalidations:function(c){return this.k.getInvalidations(this,c)},getNode:function(c){var b=this.data,d;return b&&(c&&c!==document&&k(c,b,1)||(d=b.parentNode)&&d.nodeType!==11&&h(b,1)||b)}})})();
ovi.provide("nokia.maps.map.render.p2d.dom.ImageLayer");
(function(d){var k=d.map.render.p2d.dom,h=d.dom,c={state:!1};k.ImageLayer=function(b,c,a,e){this.k=c;this.cb=e;this.f=b;this.af=c.opacity||1;this.Kl=ovi.bind(this,this.Kl);this.Be=b.ownerDocument};k.ImageLayer.prototype={Yc:-1/0,shutdown:function(){this.f.innerHTML=""},stop:function(){},show:function(){this.dq("")},hide:function(){this.dq("none")},dq:function(b){this.f.style.display=b},render:function(b,d,a,e,l,f,h,m,k,q,y,s){var d=this.k,e=this.Yc,u;if(b>=d.min&&b<=d.max){this.ih=a;if(d.getInvalidations(e)&&
(this.Yr=u=d.request(h,s,this.Kl))&&u.state)this.Ko=u,this.Yc=d.getInvalidationMark();(u=this.Ko)&&this.Pj(u)}else this.Pj(c)},Kl:function(b){if(b.state)this.Ko=b;this.Yr===b&&this.Pj(b)},Pj:function(b){var c,a;c=this.f;image=c.firstChild;bbox=b.bbox;data=b.data;opacity=this.af;data?(image||(image=this.Be.createElement("image")),c=this.ih,image.src=data.src,b=c.geoToPixel(bbox.topLeft).round(),c=c.geoToPixel(bbox.bottomRight).round(),a=image.style,a.position="absolute",a.left=b.x+"px",a.top=b.y+"px",
a.width=c.x-b.x+"px",a.height=c.y-b.y+"px",opacity!==1&&h.fd(image,opacity),this.f.appendChild(image)):image&&c.removeChild(image)},capture:function(){console.warn("ImageLayer.capture not implemented yet")}}})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.dom.CanvasLayer");
(function(d){var k=d.dom,h=d.map.render.p2d.dom;h.CanvasLayer=function(c,b,d,a){c=new h.ImageLayer(c,b,0,a);c.Pj=function(a){var b,f,c,d=this.f.firstChild||document.createElement("canvas");f=a.bbox;b=a.data;a=this.af;d.parentNode&&this.f.removeChild(d);if(b)c=this.ih,d.width=b.width,d.height=b.height,d.getContext("2d").drawImage(b,0,0),b=c.geoToPixel(f.topLeft).round(),f=c.geoToPixel(f.bottomRight).round(),c=d.style,c.position="absolute",c.left=b.x+"px",c.top=b.y+"px",c.width=f.x-b.x+"px",c.height=
f.y-b.y+"px",a!==1&&k.fd(d,a),this.f.appendChild(d)};return c}})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.dom.Animation");
(function(d){var k=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,h=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame,c=d.util.now;d.map.render.p2d.dom.Animation=ovi.Class({initialize:function(b,c,a,e){this.duration=e||300;this.Ru=b;this.gp=c;if(typeof a==="function")this.Kk=a;this.isRunning=!1},start:function(){function b(){var e=c(),l=e-d.gd,
f=l/d.duration,f=f>1?1:f;d.Kk&&(f=d.Kk(f));d.Ru(f,l,e-a,e);a=e;f>=1?d.stop():d.fk=k?k(b):setTimeout(b,15)}var d=this,a;d.gd=c();a=d.gd;d.isRunning=!0;d.fk=k?k(b):setTimeout(b,15)},stop:function(b){h?h(this.fk):clearTimeout(this.fk);this.isRunning=!1;!b&&this.gp&&this.gp()}})})(nokia.maps);ovi.provide("nokia.maps.map.render.Preloader");
nokia.maps.map.render.Preloader=new ovi.Class({initialize:function(d,k){this.yc=ovi.bind(this,this.yc);this.Jp=d;this.np=k;this.Du=setTimeout(ovi.bind(this,this.Nc));this.Tl={};this.im=[]},total:0,past:0,Nc:function(){for(var d=this.Jp,k=d.length,h=0,c,b,g,a,e,l,f=0,p=0,m=this.Tl,r;h<k;++h){this.im.push(b=d[h]);providers.addListener("response",this.yc);c=d[++h];e=d[++h];g=b.request;a=b.createId;argsLength=e.length;for(l=0;l<argsLength;)++f,g.apply(b,r=e.slice(l,l+=c))===TRUE?m[a.apply(b,r)]=1:++p}this.Jp=
0;this.state=1;this.total=f;this.past=p;this.np()},yc:function(d){var d=d.data[0],k=this.Tl;if(k[d]){k[d]=0;if(++this.past===this.total)this.Tl=0;this.np()}},Fv:function(){for(var d=that.im.length;d--;)that.im[d].removeListener("response",that.yc)},state:0,cancel:function(){clearTimeout(this.Du)}});ovi.provide("nokia.maps.map.render.InteractionRecorder");
(function(d){var k=d.util.Vector3D;d.map.render.InteractionRecorder=new ovi.Class({initialize:function(d){d=d||{};this.Cq=d.toleraceX||3;this.Dq=d.toleraceY||3;this.Yo=d.maxSpeed||300;this.Pu=d.timeDelta||300;this.Xn=d.directionTolerance||3;this.reset()},reset:function(){this.Lp=[]},setTollerance:function(d,c){this.Cq=d||3;this.Dq=c||3},recordXY:function(d,c,b,g,a){d||(d=(new Date).getTime());this.Lp.push({x:c,y:b,bx:g,by:a,time:d})},getRecorded:function(d){var c=this.Lp,b=c.length,g;d||(d=(new Date).getTime());
g=d-this.Pu;if(b===0||b>0&&g>c[b-1].time)return[];for(;b--;)if(d=c[b],d.time<g)return c.slice(b,c.length);return c},Yk:function(d,c){return d.bx===+d.bx&&c.bx===+c.bx?{dx:c.x+(c.bx-c.x)/2-(d.x+(d.bx-d.x)/2),dy:c.y+(c.by-c.y)/2-(d.y+(d.by-d.y)/2)}:{dx:c.x-d.x,dy:c.y-d.y}},getInteractionDirection:function(d){var d=this.getRecorded(d),c=d.length,b=this.Xn>1?this.Xn:2;c>1?(d=this.Yk(d[c-(b>c?c:b)],d[c-1]),d=new k(d.dx,d.dy,0)):d=new k(0,0,0);return d.normalize()},xr:function(d,c){var b=this.Yk(d,c);return Math.abs(b.dx)>
this.Cq||Math.abs(b.dy)>this.Dq},getInteractionSpeed:function(d){var d=this.getRecorded(d),c=d.length,b=0,b=0,g,a;if(c>1&&this.xr(d[c-1],d[c-2])){b=0;for(a=1;a<c;a++)g=this.Yk(d[a-1],d[a]),b+=Math.sqrt(g.dx*g.dx+g.dy*g.dy);b/=c-1;return b<=this.Yo?b:this.Yo}else return 0}})})(nokia.maps);ovi.provide("nokia.maps.map.render.KineticMove");
(function(d){d.map.render.KineticMove=new ovi.Class({initialize:function(d,h){this.Vj=h||0.5;this.fc=this.Jm=0;d&&this.setInitialSpeed(d)},setInitialSpeed:function(d){this.Jm=d;this.fc=this.getDuration()},getValue:function(d){return this.Jm+this.Vj*d},getPath:function(d){return Math.abs(this.Vj*d*d/2)},getDuration:function(){return this.Jm/this.Vj}})})(nokia.maps);ovi.provide("nokia.maps.map.IView");ovi.provide("nokia.maps.map.ICam");ovi.provide("nokia.maps.map._EngineTransition");
(function(d){var k=ovi.extend,h={"2d-3d":void 0,"3d-2d":{},"2d-panorama":{altitude:27.26},"panorama-2d":{altitude:27.26,pitch:0,yaw:0},"3d-panorama":{pitch:0,altitude:20},"panorama-3d":{pitch:0}},c={"2d-3d":{},"3d-2d":void 0,"2d-panorama":{pitch:90},"panorama-2d":{altitude:27.26},"3d-panorama":{pitch:90},"panorama-3d":{pitch:0}};d.map.Sq=new ovi.Class({start:function(){this.inProgress=!0},finish:function(){this.inProgress=!1},getHandoverCam:function(b,c,a){b=h[c+"-"+b];return b===void 0?b:k({},a,
b)},getDestinationCam:function(b,d,a){b=c[d+"-"+b];return b===void 0?b:k({},a,b)}})})(nokia.maps);ovi.provide("nokia.maps.language.Manager");
(function(d){var k=d.util.getRootNameSpace("nokia.maps").Language;d.language.Manager=ovi.Class({translateToken:function(d,c,b){b=b||k.translations;b=b[d];c&&b==null&&ovi.warn("Translation: Cannot translate token: "+d);return b||d},translate:function(h,c,b){var b=b||/__i18n_([a-z\.]*_[a-z0-9]*)__/g,g=this,a=k.translations;return h.replace(b,function(b,l){(l==null||typeof l==="number")&&d.util.c("keyRegexp does not contain a valid token group");return g.translateToken(l,c,a)})}})})(nokia.maps);ovi.provide("nokia.maps.map.HitArea");
(function(){var d=Math,k=d.PI/180,h=d.ceil,c=d.min,b=d.sin,g=d.cos,a=nokia.maps.util,e=a.Point,l=nokia.maps.map.HitArea=new ovi.Class({initialize:function(f,e){var d=(e=[].concat(e)).length,l=d,q,y,s,u,w;this.values=e;for(this.type=f;l--;)isNaN(e[l]=e[l])&&a.c("Given argument is not the array of numbers");f==="rect"&&d>3&&(e=[+e[0],+e[1],+e[2],+e[1],+e[2],+e[3],+e[0],+e[3]],f="poly");if(f==="circle"&&d>2&&(s=+e[2])>0){q=+e[0];y=+e[1];l=c(h(s)*2,40);u=360/l;for(e=[];l--;)w=u*l*k,e.push(q+b(w)*s,y+
g(w)*s);f="poly"}if(f==="poly"&&d&&!(e.length%2))this.zb=e;!this.zb&&a.c("bad polygon")},Statics:{from:function(a){return a instanceof l?a:new l(a.type,a.values?a.values:a.coords)}},hitTest:function(a,b,c){return e.isCoveredBy(a,b,this.zb,c,!0)}})})();ovi.provide("nokia.maps.util.ColorHelper");
(function(d){function k(a){var b;if(a.charAt(0)==="#")b=e[a.length]?a:null;else if(a.substr(0,3)==="rgb"){b=a.match(/\d+(\.\d+)?/g);var g=b.length;b=g>2&&g<5?["#",c(+b[0]),c(+b[1]),c(+b[2]),g>3?c(+b[3]*255):"ff"].join(""):null}b||d.c("Invalid color definition: "+a);return b}function h(a){return!/^(#|rgb).*/.test(a)}function c(a){return a<16?"0"+g(a).toString(16):g(a).toString(16)}function b(b){b=a(b,16);return(b<<4)+b}var g=Math.round,a=parseInt,e={4:function(a){return["#",a.charAt(1),a.charAt(1),
a.charAt(2),a.charAt(2),a.charAt(3),a.charAt(3),"ff"].join("")},5:function(a){return["#",a.charAt(1),a.charAt(1),a.charAt(2),a.charAt(2),a.charAt(3),a.charAt(3),a.charAt(4),a.charAt(4)].join("")},7:function(a){return a+"ff"},9:function(a){return a}},l={4:function(a){return[b(a.charAt(1)),b(a.charAt(2)),b(a.charAt(3)),255]},5:function(a){return[b(a.charAt(1)),b(a.charAt(2)),b(a.charAt(3)),b(a.charAt(4))]},7:function(b){b=a(b.substring(1),16);return[b>>16&255,b>>8&255,b&255,255]},9:function(b){b=a(b.substring(1),
16);return[b>>24&255,b>>16&255,b>>8&255,b&255]}};d.ColorHelper={toInternal:function(a){return h(a)?a:(a=k(a),e[a.length]?e[a.length](a):a)},toRGBA:function(a,b){return h(a)?[0,0,0,255]:(b||(a=k(a)),l[a.length](a))},getHex3:function(a,b){return h(a)?a:(b||(a=k(a),a=e[a.length]?e[a.length](a):a),a.substr(0,7))},getAlpha:function(b,c){return h(b)?1:(c||(b=k(b),b=e[b.length]?e[b.length](b):b),a(b.substr(7,2),16)/255)},toRandomRGBA:function(a,b){if(h(a))return"000000ff";else{for(var a=this.toRGBA(a,b),
e=0;e<4;e++)a[e]=""+c(e<3?Math.floor(Math.random()*(a[e]-0+1))+0:a[e]);return a.join("")}}}})(nokia.maps.util);ovi.provide("nokia.maps.map._packaging.components-nokia");ovi.provide("nokia.maps.dom.KeyCodes");
(function(){function d(c,b){for(var d=b.length;d--;)k[b[d]]=c+d}var k={BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,META:91,CONTEXT_MENU:93,CMD_LEFT:91,CMD_RIGHT:93};d(32,["SPACE","PAGE_UP","PAGE_DOWN","END","HOME","LEFT","UP","RIGHT","DOWN"]);d(44,["PRINT_SCREEN","INSERT","DELETE"]);d(48,["ZERO","ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE"]);d(96,["NUM_ZERO","NUM_ONE","NUM_TWO","NUM_THREE","NUM_FOUR","NUM_FIVE","NUM_SIX","NUM_SEVEN",
"NUM_EIGHT","NUM_NINE"]);d(112,["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"]);for(var h=65;h<=90;h++)k[String.fromCharCode(h).toUpperCase()]=h;nokia.maps.dom.KeyCodes=k})();ovi.provide("nokia.maps.map.provider.NullObjectProvider");
(function(d){d.map.provider.NullObjectProvider=new ovi.Class({zf:function(){},mh:function(){},mc:function(){},requestBBox:function(){return[]},cancelBBoxRequest:function(){},adopt:function(d){if(d.k)return!1;d.k=this;return d},orphan:function(d){if(d.k!==this)return!1;d.k=null;return d}})})(nokia.maps);ovi.provide("nokia.maps.map.render.Capabilities");
(function(){if(!nokia.maps.util.getConstructor(nokia.maps.map.render.Capabilities))var d=nokia.maps,k={min:0,max:0},h=(d.map.render.Capabilities=function(c){return d.util.proto(c,h,!0,!0)}).prototype={view:{heading:k,tilt:k,incline:k,distance:k,zoom:{min:-1/0,max:1/0}},cam:{fov:{min:70,max:70}},altMode:{GL:!0,OL:!1,SL:!1,SB:!1,WE:!1,WG:!1},provider:{tile:{bmp:!0,gfx:!1,mesh:!1},object:{spatial:!0,marker:!0,decal:!1}},ui:17,capture:!1,ZOOM:1,HEADING:2,TILT:4,INCLINE:8,COORD:16,FOV:32,SIZE:64}})();
ovi.provide("nokia.maps.util.EventTarget");
(function(d){var d=d.EventTarget=function(d){var d=d||this,c;if(!d.Ws)for(c in k)c in d||(d[c]=k[c]);return d},k={Ws:!0,addListener:function(d,c){var b=this.ek||(this.ek={}),b=b[d]||(b[d]=ovi.Array([]));b.indexOf(c)<0&&b.push(c)},removeListener:function(d,c){var b=this.ek,g,a;if(b&&(g=b[d]))a=g.indexOf(c),a>=0&&(g.splice(a,1),a<=g.li&&--g.li),g.length||delete b[d]},dispatch:function(d){var c=this.ek,b;d.target=this;if(c&&(b=c[d.type])){for(c=0;c<b.length;c++)b.li=c,b[c].call(this,d),c=b.li;b.li=NaN}return!d.defaultPrevented}};
ovi.extend(d.prototype,k)})(nokia.maps.util);ovi.provide("nokia.maps.geo.PixelProjection");
(function(d){var k=d.util,h=k.Point,c=k.c,d=d.geo.PixelProjection=function(b,d,a,e,l){(this.p=b)&&(this.w=+d)>0&&(this.h=+a)>0||c();if(e)this.x=+e;if(l)this.y=+l};ovi.extend(d.prototype,{x:0,y:0,geoToPixel:function(b){b=this.p.latLngToPoint(b.latitude,b.longitude);return new h(b.x*this.w-this.x,b.y*this.h-this.y)},latLngToPixel:function(b,c){var a=this.p.latLngToPoint(b,c);return new h(a.x*this.w-this.x,a.y*this.h-this.y)},pointToPixel:function(b){return new h(b.x*this.w-this.x,b.y*this.h-this.y)},
xyToPixel:function(b,c){return new h(b*this.w-this.x,c*this.h-this.y)},pixelToPoint:function(b){return new h((b.x+this.x)/this.w,(b.y+this.y)/this.h)},xyToPoint:function(b,c){return new h((b+this.x)/this.w,(c+this.y)/this.h)},pixelToGeo:function(b){return this.p.xyToGeo((b.x+this.x)/this.w,(b.y+this.y)/this.h)},xyToGeo:function(b,c){return this.p.xyToGeo((b+this.x)/this.w,(c+this.y)/this.h)}})})(nokia.maps);ovi.provide("nokia.maps.map.component.KeyControl");
(function(d){function k(){this.values={}}function h(a,b,c,f,d,g,h,k){this.Xs=a;this.dp=b;this.ep=c;this.fp=f;this.$p=d;this.aq=g;this.bq=h;this.Pq=k}var c=d.map.component,b=d.dom.KeyCodes,g={duration:function(){return 600},power:function(){return 0.35},ease:d.util.animation.easeFunctions.EASE_OUT_CIRC};h.prototype={applies:function(a){var e=this.Xs,c=e&1024,f=e&2048,d=e&4096,g=e&8192;(e=a[e-(c?1024:0)+(f?2048:0)+(d?4096:0)+(g?8192:0)])&&(e=c&&a[b.SHIFT]||!c&&!a[b.SHIFT]);e&&(e=f&&a[b.CTRL]||!f&&!a[b.CTRL]);
e&&(e=d&&a[b.ALT]||!d&&!a[b.ALT]);e&&(e=g&&a[b.META]||!g&&!a[b.META]);return e}};k.prototype={add:function(a,b,c,f,d,g,k,q){this.values[a]=new h(a,b,c,f,d,g,k,q)},isMapped:function(a){var b=this.values,c;for(c in b)if(b.hasOwnProperty(c)&&c&a)return!0},remove:function(a){delete this.values[a]},query:function(a){var b=[],c=this.values,f;for(f in c)c[f].applies(a)&&b.push(c[f]);return b}};k.MOD_SHIFT=1024;k.MOD_ALT=1024;k.MOD_CTRL=1024;k.MOD_META=8192;c.KeyControl=new ovi.Class({d:"KeyControl",n:"0.0.0.1",
Extends:c.Component,Statics:{CAM_KEYMAP:function(){var a=new k;a.add(b.UP,0,0,0,-0.015);a.add(b.DOWN,0,0,0,0.015);a.add(b.LEFT,0,0,0,0,0.015);a.add(b.RIGHT,0,0,0,0,-0.015);a.add(1024|b.RIGHT,0,0,0,0,-0.015);a.add(1024|b.LEFT,0,0,0,0,0.015);a.add(1024|b.UP,0,0,0,-0.015);a.add(1024|b.DOWN,0,0,0,0.015);a.add(107,0,0,0,0,0,0,0.02);a.add(109,0,0,0,0,0,0,-0.02);a.add(187,0,0,0,0,0,0,0.02);a.add(189,0,0,0,0,0,0,-0.02);a.add(171,0,0,0,0,0,0,0.02);a.add(173,0,0,0,0,0,0,-0.02);return a}(),VIEW_KEYMAP:function(){var a=
new k;a.add(b.UP,0,0.0020);a.add(b.DOWN,0,-0.0020);a.add(b.LEFT,-0.0020);a.add(b.RIGHT,0.0020);a.add(107,0,0,0.0010);a.add(109,0,0,-0.0010);a.add(187,0,0,0.0010);a.add(189,0,0,-0.0010);a.add(171,0,0,0.0010);a.add(173,0,0,-0.0010);a.add(1024|b.RIGHT,0,0,0,0,0.015);a.add(1024|b.LEFT,0,0,0,0,-0.015);a.add(1024|b.UP,0,0,0,0.015);a.add(1024|b.DOWN,0,0,0,-0.015);return a}(),KeyMap:k},initialize:function(){this.Ki=ovi.bind(this,this.Ki);this.Li=ovi.bind(this,this.Li);this.se=ovi.bind(this,this.se);this.Ga=
ovi.bind(this,this.Ga);this.bk=ovi.bind(this,this.bk);this.tl=0;this.ur=c.KeyControl.CAM_KEYMAP;this.av=c.KeyControl.VIEW_KEYMAP;this.re=null;this.zm("view");this.td={}},attach:function(a){this._super(a);a.addListener("keydown",this.Ki);a.addListener("keyup",this.Li);a.addListener("blur",this.se);a.addListener("focus",this.se);a.addListener("dragstart",this.Ga)},detach:function(a){a.removeListener("keydown",this.Ki);a.removeListener("keyup",this.Li);a.removeListener("blur",this.se);a.removeListener("focus",
this.se);a.removeListener("dragstart",this.Ga);this._super(a)},zm:function(a){this.Mr=a;switch(a){case "cam":this.re=this.ur;break;case "view":this.re=this.av}},dk:function(a,b){a.zoom=b?Math.ceil(a.zoom):Math.floor(a.zoom);a.distance=void 0;return a},bk:function(a,b){return this.dk(ovi.extend({},b),b.zoom-a.zoom>0)},Yq:function(){return!1},ao:function(a){var b=a.length,c=b,f,d,m,h,k,y,s,u;for(d=m=h=k=y=s=u=0;b--;)f=a[b],d===0&&(d=f.dp?f.dp:0),m===0&&(m=f.ep?f.ep:0),h===0&&(h=f.fp?f.fp:0),k===0&&
(k=f.$p?f.$p:0),y===0&&(y=f.aq?f.aq:0),s===0&&(s=f.bq?f.bq:0),u===0&&(u=f.Pq?f.Pq:0);c?(this.tl||this.mapDisplay.beginControl(this.Mr,g),this.mapDisplay.control(null,d,m,h,k,y,s,h?0:u)):this.tl&&this.mapDisplay.endControl(this.bk);this.tl=c},Vt:function(a){var b;this.re.isMapped(a)&&!this.td[a]&&(this.td[a]=1,b=this.re.query(this.td),this.ao(b));return b?b.length:0},Op:function(a){var b;this.re.isMapped(a)&&this.td[a]&&(delete this.td[a],b=this.re.query(this.td),this.ao(b));return b?b.length:0},Ki:function(a){var b=
a.nativeEvent;this.Vt(b.keyCode||b.which)&&a.preventDefault()},Li:function(a){a=a.nativeEvent;this.Op(a.keyCode||a.which)},se:function(){var a=this.td,b;for(b in a)this.Op(a[b])},Ga:function(){this.mapDisplay.endControl(this.Yq)},isCompatible:function(){this.mapDisplay.baseMapType===nokia.maps.map.Display.PANORAMA?this.zm("cam"):this.zm("view");return!0}})})(nokia.maps);ovi.provide("nokia.maps.map.render.p2d.dom.capabilities");var $b=nokia.maps.map.render;
$b.p2d.dom.capabilities=$b.Capabilities({view:{distance:{max:1/0},zoom:{min:-8,max:22}},cam:{fov:{min:70,max:70}},provider:{tile:{gfx:!0}}});ovi.provide("nokia.maps.css");
(function(d){var k=d.css,h=d.dom.Page.browser,c=d.dom.Page.platform,c=c.ipad||c.iphone||c.ipod,b=h.gecko?"Moz":h.opera?"O":h.msie?"ms":h.webkit?"Webkit":null,g=(h.gecko&&h.version>=10||c||h.safari?2:0)|(h.msie&&h.version<10||h.gecko&&h.version<=4?0:1),a={};ovi.extend(k,{transformType:g,Zu:b,ln:b?"-"+b.toLowerCase()+"-":"",Hq:b==="O"?"oTransitionEnd":b==="Webkit"?"webkitTransitionEnd":b==="MS"?"MSTransitionEnd":"transitionend",getVendorJsProperty:function(e){return a[e]||(a[e]=b+e.substr(0,1).toUpperCase()+
e.substr(1))},css3Style:function(a,c,f){a=a.style;a[c]=f;b&&(a[this.getVendorJsProperty(c)]=f)},cssTransform:function(a,b){this.css3Style(a,"transform",b)},cssTransformOrigin:function(a,b){this.css3Style(a,"transformOrigin",b)},cssTransformStyle:function(a,b){this.css3Style(a,"transformStyle",b)},cssBackfaceVisibility:function(a,b){this.css3Style(a,"backfaceVisibility",b)},supportsTransition:function(){return!h.msie||h.version>=10},applyMatrix:!g?function(a,b){var f=b.rows;a.style.top=f[1][3]+"px";
a.style.left=f[0][3]+"px"}:function(a,b){var f=b.rows;g&2?a.style[k.getVendorJsProperty("transform")]="matrix3d("+f[0][0]+","+f[1][0]+","+f[2][0]+",0,"+f[0][1]+","+f[1][1]+","+f[2][1]+",0,"+f[0][2]+","+f[1][2]+","+f[2][2]+",0,"+f[0][3]+","+f[1][3]+","+f[2][3]+",1)":a.style[k.getVendorJsProperty("transform")]="matrix("+f[0][0]+","+f[1][0]+","+f[0][1]+","+f[1][1]+","+f[0][3]+","+f[1][3]+")"},transformElement:function(a,b,f,c,g,h){var q=k.transformType;q&2||q&1?(q=new d.util.Matrix3D,q=q.translate(b,
f,0),c&&(q=q.rotateZ(c)),g&&g!==1&&(q=q.scale(g,h!==void 0?h:g,1)),k.applyMatrix(a,q)):(a=a.style,a.left=b+"px",a.top=f+"px")}})})(nokia.maps);ovi.provide("nokia.maps.map.provider.Provider");
(function(){var d=0,k=Math,h=k.min,c=k.max,b=[],g=nokia.maps.util.Event;nokia.maps.map.provider.Provider=new ovi.Class({methodsToBind:[],staticsToBind:[],Extends:nokia.maps.util.EventTarget,initialize:function(a){var b=this;ovi.extend(b,a);if(a&&"strictUpdate"in a&&!("strictInvalid"in a))b.strictInvalid=b.strictUpdate;b.id=d++;b.max=h(b.max,30);b.min=c(b.min,0);a=c(0,b.updateCycle);if(a>0)b.Vu=setInterval(function(){b.cn()},a*1E3);b.$d={};b.Tu=function(){b.cn();b.Lq=0};b.nr()},pType:1,min:0,max:-1,
label:"",description:"",strictUpdate:!1,strictInvalid:!1,yg:0,providesLevel:function(a){return a>=this.min&&a<=this.max},getInvalidationMark:function(){return this.yg},update:function(){this.Lq||(this.Lq=setTimeout(this.Tu,0))},cn:function(){++this.yg;this.dispatch(new g("update"))},getCopyrights:function(){return b},shutdown:function(){clearInterval(this.Vu);delete this.qv},lr:function(a){for(var b=this.methodsToBind,c=b.length;c--;)this[b[c]]=ovi.bind(a,a[b[c]])},nr:function(){for(var a=this,b=
a.staticsToBind,c=b.length;c--;)a[b[c]]=function(f){return function(){var c=a.ys();return c[b[f]].apply(c,arguments)}}(c)}})})();ovi.provide("nokia.maps.map.render.p2d.dom.MarkerLayer");
(function(d){var k=[],h=d.util,c=d.map.provider,b=d.map.render.p2d.dom._helpers.geoToScreen,g=h.Point,a=h.Rectangle,e=d.css,l=d.dom.cloneNode;nokia.maps.map.render.p2d.dom.MarkerLayer=new ovi.Class({initialize:function(a,b,e,g){this.f=a;a.className=e.cssClass+"_markerLayer";this.B=a.ownerDocument;this.k=b;this.ml=b instanceof c.LocalObjectProvider;this.ql={};this.yo=[];this.di=new d.util.Cache(128);this.cb=g},nc:0,Qb:function(a,b,e){for(var c=this.ql,d=this.yo,l,h,u=d.length,w,v;u--;)if(h=d[u],l=
c[h],h=l[1],h.contains(new g(a,b))&&(h=h.topLeft,l=l[0],w=l.hitArea,!w||w.hitTest(a-h.x,b-h.y)))if(v||(v=[]),v.push(l),e)break;return v||k},Mt:function(a,b,c){var d=this.f;e.transformElement(a,b.x,b.y);a.style.zIndex=-c;a.parentNode!==d&&d.appendChild(a)},stop:function(){},shutdown:function(){this.f.innerHTML="";this.cb=h.J;return this.f},show:function(){if(this.nc)this.f.style.display="",this.nc=0},hide:function(){var a=this.f.style;if(!this.nc)this.nc=1,a.display="none"},Yc:-1/0,render:function(a,
e,c,d,g,h,k,u,w,v,x,z){var a=this.Yc,d=this.k,k=d.requestBBox(k,2,x,z),x=k.length,g=this.f,u=this.ql,w={},v=this.yo,A,B,D,E,G,N,Q=this.di,X=this.B,J=!z,C=this.ml;for(v.length=0;x--;)if((B=C?k[x]:k[x].getObject(!0))&&B!==!0){D=0;E=B.id;A=u[E];N=b(B.coordinate,c).sub(B.anchor);A&&(G=A[2])?d.getInvalidations(B,a)?D=B.getIconForRendering(X):z||Q.get(B.getIconForRendering(X).d):(G=Q.get(B.getIconForRendering(X).d,z))?G=l(G,1):z||(D=B.getIconForRendering(X));if(D)G=D.createElement(),G.style.position="absolute",
Q.add(D.d,G),G=l(G,1),A&&(g.removeChild(A[2]),A[2]=G);G&&(D||(D=B.getIconForRendering(X)),A?(A[1]=this.lo(B,c,e,h,D),u[E]=0,w[E]=A):w[E]=[B,this.lo(B,c,e,h,D),G],v.push(E),this.Mt(G,N,x))}if(g.childNodes.length)for(E in u)(A=u[E])&&g.removeChild(A[2]);this.Yc=d.getInvalidationMark();this.ql=w;this.cb("marker");return J},lo:function(e,c,d,l,h){e=b(e.coordinate,c).sub(e.anchor);return new a([e,new g(e.x+h.width,e.y+h.height)])},uv:function(a,b,e,c,d){var l=new g(b,e);return a.contains(l)&&(!c||c.hitTest(b-
bbox.topLeft.x,e-bbox.topLeft.y,d))},capture:function(){console.warn("markerLayer.capture not implemented yet")}})})(nokia.maps);ovi.provide("nokia.maps.map.provider.BitmapProvider");
nokia.maps.map.provider.BitmapProvider=new ovi.Class({Extends:nokia.maps.map.provider.Provider,request:function(d,k,h){var c=this,b,g=this.getBoundingBox();if(g.intersects(d))return d=this.getId(),this.cache&&(b=this.cache.get(d)),b===void 0&&!k&&(b=this.create(d,g,k)),k||b.send(function(a){c.cache&&a.state!==void 0&&c.cache.add(a.id,a);h(a)}),b},getInvalidations:function(d){return(d<this.getInvalidationMark())*1}});ovi.provide("nokia.maps.map.provider.CanvasProvider");
(function(){function d(d,c,b){this.id=d;this.bbox=c;this.provider=b}var k;ovi.extend(d.prototype,{send:function(d){var c=this;this.data=k=k||document.createElement("canvas");this.provider.draw(this.data,function(b,g){c.state=g;c.data=b;d(c)})},abort:function(){}});nokia.maps.map.provider.CanvasProvider=new ovi.Class({Extends:nokia.maps.map.provider.BitmapProvider,initialize:function(d){this._super(d)},create:function(h,c){return new d(h,c,this)},getId:function(){return this.id},getInvalidations:function(d){return(d<
this.getInvalidationMark())*1}});nokia.maps.map.provider.CanvasProvider.Request=d})();ovi.provide("nokia.maps.map.provider.PanoramaProvider");
(function(d){d.map.provider.PanoramaProvider=new ovi.Class({Extends:d.map.provider.Provider,methodsToBind:["getPanoramaId"],staticsToBind:["hasCoverage","isCovered","getClosestPanorama","loadCoverage"],initialize:function(d){this._super(d);this.pType=2;this.min=this.max=22},ys:function(){return d.map.render.panorama.Engine},getCopyrights:function(k,h){return d.map.js.copyrights.get("panorama",k,h)}})})(nokia.maps);ovi.provide("nokia.maps.map.provider.GlobeProvider");
(function(d){d.map.provider.GlobeProvider=new ovi.Class({Extends:d.map.provider.Provider,initialize:function(d){this._super(d);this.pType=4;this.max=Infinity;this.min=0},getCopyrights:function(k,h){return d.map.js.copyrights.get("globe",k,h)}})})(nokia.maps);ovi.provide("nokia.maps.map.overlay.ObjectProvider");
nokia.maps.map.overlay.ObjectProvider=new ovi.Class({Extends:nokia.maps.map.provider.Provider,Mixins:[nokia.maps.util.OObject],readyObjects:null,cache:nokia.maps.util.J,finishRequest:function(d,k){k&&(this.notify(d),this.cache(d))},notify:function(d){this.set("readyObjects",d)}});ovi.provide("nokia.maps.map.render.p2d.dom.TileLayer");
(function(){var d=Math,k=d.abs,h=d.round,c=d.floor,b=d.log,g=d.LN2,a=d.pow;new Image;var e=ovi.browser.msie,l=nokia.maps,f=l.util,p=f.Point,m=f.Ne,r=l.dom,q=l.css,y=l.gfx.Painter.defaultPainter,s=r.cloneNode,u=nokia.maps.map.render.p2d.dom.TileLayer=new ovi.Class({initialize:function(a,b,e,f){this.af=b.opacity||1;a.style.position="absolute";this.Mu=e.cssClass+"Tile";this.f=a;this.k=b;this.cb=f;this.B=a.ownerDocument;this.Bc={};this.tj={};this.bm=0;this.Rd=new y;this.vh=new p(-1,-1);b.addListener("response",
this.yc=ovi.bind(this,this.yc))},Statics:{Wk:function(a,e){return h(b(e.w/a.width)/g)},no:function(b,e,f){isNaN(f)&&(f=u.Wk(b,e));return new p(e.w/(a(2,f)*b.width),e.h/(a(2,f)*b.height))},Hr:function(a,b,e,f,d,g,l,q,r,s){var y,X,J,C,H,l=[],r=isNaN(r)?u.Wk(a,b):h(r);if(a.providesLevel(r)){q=q.sub(f);g=a.Jb;s=s||u.no(a,b,r);b=new p(g.x*s.x,g.y*s.y);if(b.x%1||b.y%1)b=b.round(),s.x=b.x/g.x,s.y=b.y/g.y;b=a.pixelProjections[r];d=new p(d.x*b.w-f.x/s.x,d.y*b.h-f.y/s.y);b=new p(m(d.x,g.x),m(d.y,g.y));d=d.sub(b).round();
y=(new p(b.x*-s.x,b.y*-s.y)).sub(f).round();b=(new p(g.x*s.x,g.y*s.y)).round();s=b.divide(2);e=e.sub(f);f=c(d.y/g.y);for(X=y.y;X<e.y;X+=b.y){J=c(d.x/g.x);for(C=y.x;C<e.x;C+=b.x)(H=a.createId(r,f,J))&&l.push({qn:C,sn:X,d:H,qc:r,mu:f,Br:J++,Ip:k(q.x-(C+s.x))+k(q.y-(X+s.y))});f++}}return l}},Yc:-1/0,nc:0,mm:-1,hp:function(){var a,b,e;if(q.supportsTransition()){a=this.f.children;b=a.length;for(e=this.af;b--;)this.Iq(a[b],e)}this.cb(this)},stop:function(a,b){var e=this.tj,f,c=this.k;if(this.bm)for(f in e)e[f]&&
(c.cancel(f),this.yc({data:[f]}));this.tj=a||{};this.bm=b||0},shutdown:function(){this.cb=f.J;this.k.removeListener("response",this.yc);this.Bc={};this.stop();this.f.innerHTML="";return this.f},iv:function(){var a=this.Bc,b;for(b in a)this.xj(a,b);this.Bc={};this.stop()},yc:function(a){var b=a.data,a=b[0],b=b[1],e=this.tj,f=e[a],c,d=0,g,l,m=this.af;this.xj(this.Bc,a);if(f){if(b)for(g=f.length;d<g;)(c=f[d]).Oc=b,(c.Tb=l=this.Hp(b.getNode(this.B),d++)).style.position="absolute",q.supportsTransition()?
(this.uj(a,c,this.Bc,0),this.Iq(l,m)):this.uj(a,c,this.Bc,m);e[a]=0;--this.bm||this.hp()}},Iq:function(a,b){setTimeout(function(){r.fd(a,b)},20)},Kp:function(a,b,e){var f=0,c=a[b]||(f=1,a[b]=[]);e?c.push(e):a[b]=0;return f},Ot:function(a,b){var e=a[b];return e&&(e.length<2?(a[b]=0,e[0]):e.pop())},Ds:function(a,b){var e=a[b];return e&&e[0]},Tp:function(a){this.f.removeChild(a.Tb)},xj:function(a,b){var e=a[b],f;if(e&&a.hasOwnProperty(b)){for(f=e.length;f--;)this.Tp(e[f]);a[b]=0}},Mn:function(a,b){b||
(b={d:a.d});b.qc=a.qc;b.Oc=a.Oc;b.Tb=s(a.Tb,!0);return b},uj:function(a,b,e,f){var c=b.Tb,d=this.vh;l.css.transformElement(c,b.qn,b.sn);this.iq(d.x,d.y,b);this.jq(c,f);c.parentNode!==this.f&&this.f.appendChild(c);this.Kp(e,a,b);this.k.providesLevel(b.qc)&&this.show()},jq:function(a,b){b!==1&&r.fd(a,b)},iq:function(a,b,e){e=e.Tb.style;e.width=a+"px";e.height=b+"px"},Hp:function(a,b){var f=a.parentNode;if(f&&(!e||f.nodeType!==11)&&(b||f!==this.f))a=s(a,!0);a.className=this.Mu;return a},show:function(){if(this.nc)this.f.style.display=
"",this.nc=!1},hide:function(){if(!this.nc)this.f.style.display="none",this.nc=!0},Cu:function(a,b){return b.Ip-a.Ip},render:function(a,b,e,f,c,d,g,l,m,k,p,q,r){var a=this.k,f=u.no(a,e,p=isNaN(p)?u.Wk(a,e):p),b=u.Hr(this.k,e,c,d,b,m,k,r,p,f),e=b.length,s,c=this.Bc,d={},m=this.tj,k={},y,r=0,ba,S,g=a.strictInvalid,l=this.Yc,da=this.af;this.mm=p;this.vh.x=h(a.Jb.x*f.x);this.vh.y=h(a.Jb.y*f.y);if(!q)this.Yc=a.getInvalidationMark(),b.sort(this.Cu);for(;e--;){ba=!1;p=b[e];s=p.d;f=this.Ot(c,s);if(!f&&(f=
this.Ds(d,s)))ba=1;if(!f||!ba&&a.getInvalidations(f.Oc,l))if(m[s]?(m[s]=0,y=!0):y=k[s]?!0:a.request(p.qc,p.mu,p.Br,q),y===!0?(S=1,r+=this.Kp(k,s,p)):y?(p.Oc=y,p.Tb=this.Hp(y.getNode(this.B)),this.uj(s,p,d,da)):S=1,f&&(g||y!==!0&&(!q||y!==!1)))this.Tp(f),ba||this.xj(c,s),f=0;if(f)ba&&(f=this.Mn(f)),f.qn=p.qn,f.sn=p.sn,this.uj(s,f,d,da)}this.stop(k,r);for(s in c)this.xj(c,s);this.Bc=d;q||r||this.hp();return!r&&!S},capture:function(){console.warn("TileLayer.capture not implemented yet")}})})();ovi.provide("nokia.maps.map.provider.ImageProvider");
(function(){function d(d,c,b){this.id=d;this.provider=b;this.bbox=c}var k=nokia.maps.dom.imgLoader;ovi.extend(d.prototype,{send:function(d){var c=this;this.state=k.request(this.data=new Image,this.id,function(b,g){c.state=g;d(c)})},abort:function(){k.cancel(this.data)}});nokia.maps.map.provider.ImageProvider=new ovi.Class({Extends:nokia.maps.map.provider.BitmapProvider,initialize:function(d){this._super(d)},create:function(h,c){return new d(h,c,this)},getId:function(){return this.getUrl()},getInvalidations:function(d){return(d<
this.getInvalidationMark())*1}});nokia.maps.map.provider.ImageProvider.Request=d})();ovi.provide("nokia.maps.map.DisplayContainer");
(function(){var d=nokia.maps,k=d.dom,h=ovi.Array.indexOf,c=d.util;nokia.maps.map.DisplayContainer=new ovi.Class({initialize:function(b,d){function a(a){if(l.enabled){var e=u.getClientRect(q),f=+a.pageX,c=+a.pageY,d,g,m=a.type,k=a.dataTransfer,r,s=null;r=null;var y=E,z=-1;if(b.width!==b.O.offsetWidth||b.height!==b.O.offsetHeight)b.bf(b.O.offsetWidth,b.O.offsetHeight),(a.type=="resizestart"||a.type=="resize")&&b.yu(16);a.display=b;if(!v[m]&&f===f&&c===c&&(a.displayX=d=f-e.left,a.displayY=g=c-e.top,
m!=="drag"&&m!=="drop"&&m!=="dragend"&&m!=="dragleave"&&m!=="gesturestart"&&m!=="gesturechange"&&m!=="gestureend"))a.displayObjects=s=b.getObjectsAt(a.displayX,a.displayY);r=s&&s.length>0&&s[0]||b;if(m==="dragstart"){for(r=Q(r);r&&r.length;){if(r[0]&&r[0].draggable)break;r.shift()}A=r=r&&r[0]||b;D=!1}else if(m==="drag")r=A;else if(k&&(m==="dragenter"||m==="dragover"||m==="dragleave")){m==="dragleave"&&(r=null);B!==r&&(m=new p({type:"dragleave",target:B,relatedTarget:A,pageX:f,pageY:c,display:b,displayX:d,
displayY:g,dataTransfer:k}),N(B,m),B=null,D=!1);if(!B&&r)m=new p({type:"dragenter",target:B=r,relatedTarget:A,pageX:f,pageY:c,display:b,displayX:d,displayY:g,dataTransfer:k}),N(B,m),D=m.defaultPrevented;D?(m=new p({type:"dragover",target:B,relatedTarget:A,pageX:f,pageY:c,display:b,displayX:d,displayY:g,dataTransfer:k}),N(B,m)):k.dropEffect="none";a.cancel();return}else if(m==="drop"){B&&D?(m=a.clone(),m.target=B,N(B,m)):k.dropEffect="none";a.cancel();return}else if(m==="dragend")a.target=r=A,A=B=
null,D=!1;else{if(v[m]||E&&E!==r)f=a.clone(),f.type="mouseout",f.target=E,f.relatedTarget=v[m]?a.relatedTarget:r,N(E,f),E=null;for(;++z<G.length;)if((!s||h(s,G[z])<0)&&(G[z]!==b||v[m]))f=a.clone(),f.type="mouseleave",f.target=G[z],delete f.relatedTarget,N(f.target,f),G.splice(z--,1);if(!v[m]&&!E){if(h(G,r)<0)f=a.clone(),f.type="mouseenter",f.target=r,delete f.relatedTarget,N(r,f),G.push(r);f=a.clone();f.type="mouseover";f.target=E=r;f.relatedTarget=w[m]?a.relatedTarget:y;N(E,f)}}if(!v[m]&&!w[m])a.target=
r,N(r,a)}}function e(a,b,e){return(b in x?m:q)[a+"Listener"](b,e,void 0)}var l=this,f=k.EventTarget,p=k.Event,m=f(k.Qa(d,"div")),r=k.Qa(m,"div"),q=f(k.Qa(r,"div")).enableDrag(),y=k.Qa(m,"div"),s=k.Qa(r,"div"),b=f(b).enableDrag(),u=l.gh=k.Page(q),w={mouseover:!0,mouseenter:!0},v={mouseout:!0,mouseleave:!0,blur:!0},x={keydown:!0,keyup:!0,focus:!0,blur:!0},z={dragstart:!0,drag:!0,dragenter:!0,dragover:!0,drop:!0,dragleave:!0,dragend:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mouseup:!0,keydown:!0,
keyup:!0,focus:!0,blur:!0,tap:!0,dbltap:!0,click:!0,dblclick:!0,longpress:!0,mousewheel:!0,contextmenu:!0,resizestart:!0,resize:!0,resizeend:!0,beforeunload:!0,touchstart:!0,touchmove:!0,touchend:!0},A,B,D,E=null,G=[],N=f.dispatchEvent,Q=f.getDispatchPath,X;l.doc=d.ownerDocument;l.f=d;l.enabled=!0;m.tabIndex=0;(l.O=m).style.cssText+="position:relative;width:100%;height:100%;overflow:hidden;outline:none;";b.ed("width",m.offsetWidth);b.ed("height",m.offsetHeight);(l.$e=q).style.cssText+="position:absolute;z-index:0;width:100%;height:100%;overflow:hidden;";
if(ovi.browser.msie)q.style.backgroundColor="white",nokia.maps.dom.fd(q,0);(l.ji=r).style.cssText+="position:absolute;z-index:0;width:100%;height:100%;overflow:hidden;";(l.P=y).style.cssText+="z-index:0;";l.Mh=k.Page(y);l.Sa=s;for(X in z)e("add",X,a);l.addEvent=function(b){z[b]=!0;return e("add",b,a)};l.removeEvent=function(b){delete z[b];return e("remove",b,a)};l.containerDestroy=function(){var b=this,f;for(f in z)e("remove",f,a);try{d.removeChild(m)}catch(l){}setTimeout(function(){for(var a in b)b[a]=
typeof b[a]=="function"?c.J:null},0)}}})})();ovi.provide("nokia.maps.map.render.p2d.dom.MapLayer");
(function(d){function k(a,b){return a.Sj-b.Sj}var h=d.dom,c=Math.abs,b=Math.pow,g=d.map.render.p2d.dom;d.map.render.p2d.dom.MapLayer=new ovi.Class({initialize:function(a,b,c,f){var d,m;this.Ti=d=b.min;this.Ua=m=b.max;this.k=b;this.cb=f;this.f=a;this.Oi=a=[];this.uo=c.fading*1.1+20;for(this.xc=ovi.bind(this,this.xc);d<=m;d++)a[d]=new g.TileLayer(h.Qa(this.f,"div"),b,c,this.xc),a[d].tf=d},shutdown:function(){var a=this.Ti,b=this.Oi,c=b.length;for(this.cb=d.util.J;c--&&c>=a;)b[c].shutdown();this.f.innerHTML=
"";return this.f},stop:function(){for(var a=this.Ti,b=this.Oi,c=b.length;c--&&c>=a;)b[c].stop()},xc:function(a){var b=this,c;if(a===b.xf)c=function(){b.Ks(a)},b.uo?b.vo=setTimeout(c,b.uo):c(),b.cb(b)},vo:null,Ks:function(a){for(a=a.Sj;a--;)this.nq[a].hide()},vu:function(a){for(var b=this.Oi,d=b.length,f=this.Ti,g;d--&&d>=f;)g=a-d,b[d].cv=g,b[d].Sj=-c(2*g-(g>0))},render:function(a,e,c,f,d,g,h,q,y,s,u,w,v){var u=Math.round(u),x=this.Ti,z=this.Ua,A=this.Oi,B,D;clearTimeout(this.vo);this.xf&&this.xf.tf!==
u&&this.xf.stop();this.xf=A[u];this.vu(u);this.nq=u=A.slice(x,z+1).sort(k);for(D=u.length;D--;)u[D].Sj=D;for(A=!(D=u.length);D--;)x=u[D],z=x===this.xf,B=u[D].cv,A||B&&(B<-2||B>4)?x.hide():(b(2,B),A=x.render(a,e,c,f,d,g,h,q,y,s,x.tf,w||!z,v)&&!z),this.nq[D].f.style.zIndex=D-100;return A},capture:function(){console.warn("MapLayer.capture not implemented yet")}})})(nokia.maps);ovi.provide("nokia.maps.map.js.copyrights");ovi.provide("nokia.maps.resources.copyrights.json");
nokia.maps.resources.copyrights.json='/*\n * Fetched 2010-11-08 from\n * http://maptile.maps.svc.ovi.com/maptiler/v2/copyright/newest?referer=&token=&output=xml&callback_func=BAR&callback_id=FOO\n *\n * Manually correction by Thomas Fischer:\n * - add missing default copyrights (whole world, level 0-20) for "normal" and "hybrid"\n * - fix wrong label for Chineese "normal" map from "NAVTEQ 2010" into "NavInfo 2010"\n * - changed all "2010" to "2011"\n *\n * Update by Michal Aichinger\n * - changed all "2011" to "2012"\n * \n * - change all "2012" to "2013"\n * - all labels should be in form "@ year company", not "@ company year"\n * - replace all Navteq by Nokia\n * - fixed hybrid copyright to not repeat Nokia for zoom levels 9 - 20, hybrid is copyrighted to Nokia and DigitaGlobe in whole space.  \n *\n * Update by Radek\n * - adding C3 Technologies for globe\n * - adding INEGI to terrain since it is in fact terrain hybrid\n * - currently we are loading copyrights from http://maps.nlp.nokia.com/maptile/2.1/copyright/newest and we use this one to updated missing features (or as fallback)\n */\n\n{\n\t"panorama": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 22,\n\t\t\t"label": "2013 Nokia",\n\t\t\t"alt": "copyright 2013 Nokia All Rights Reserved"\n\t\t}\n\t],\n\t\n\t"globe": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 Nokia",\n\t\t\t"alt": "copyright 2013 Nokia All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 DigitalGlobe",\n\t\t\t"alt": "copyright 2013 DigitalGlobe, Inc."\n\t\t},\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 C3 Technologies",\n\t\t\t"alt": "copyright 2013 C3 Technologies All Rights Reserved"\n\t\t}\n\t],\n\t\n\t"normal": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 Nokia",\n\t\t\t"alt": "copyright 2013 Nokia All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 4,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 INEGI",\n\t\t\t"alt": "copyright 2013 INEGI All Rights Reserved",\n\t\t\t"boxes": [\n\t\t\t\t[14.5333, -118.3666, 32.7166, -86.7]\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t"minLevel": 9,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 NavInfo",\n\t\t\t"alt": "copyright 2013 NavInfo Co Ltd. All Rights Reserved",\n\t\t\t"boxes": [\n\t\t\t\t[29.1171, 84.2005, 41.5657, 124.1865],\n\t\t\t\t[41.5630, 85.7494, 47.1087, 90.6305],\n\t\t\t\t[41.5601, 90.6025, 42.5667, 101.8172],\n\t\t\t\t[42.5506, 90.6234, 44.2497, 95.3195],\n\t\t\t\t[30.4401, 80.8031, 45.1197, 85.7610],\n\t\t\t\t[23.3901, 98.7867, 29.1184, 120.0226],\n\t\t\t\t[26.3574, 120.0168, 29.1201, 122.1214],\n\t\t\t\t[41.5652, 112.0222, 44.7488, 126.5498],\n\t\t\t\t[44.7472, 119.9286, 49.3447, 129.5186],\n\t\t\t\t[49.3350, 120.7819, 53.0810, 125.4870],\n\t\t\t\t[43.0083, 126.5408, 47.7089, 130.9583],\n\t\t\t\t[45.3400, 130.9452, 47.6509, 133.1190],\n\t\t\t\t[36.0000, 76.8533, 40.9910, 80.8040],\n\t\t\t\t[48.0400, 116.5004, 49.5037, 120.7834],\n\t\t\t\t[18.1302, 108.0738, 23.4047, 117.3293],\n\t\t\t\t[22.8489, 99.5674, 23.4100, 104.7658],\n\t\t\t\t[28.3256, 85.1978, 29.1306, 92.9427],\n\t\t\t\t[38.5986, 74.5747, 40.2635, 76.8557],\n\t\t\t\t[30.9888, 79.6755, 34.1592, 80.8057],\n\t\t\t\t[45.1121, 82.8615, 46.8092, 85.7618],\n\t\t\t\t[47.1043, 85.7107, 48.3877, 88.5712],\n\t\t\t\t[44.2477, 90.6263, 44.9384, 93.5556],\n\t\t\t\t[21.9867, 106.8269, 23.4067, 108.0747],\n\t\t\t\t[42.0392, 126.5396, 43.0312, 129.2131],\n\t\t\t\t[28.0162, 96.1699, 29.1244, 97.3297],\n\t\t\t\t[27.6988, 98.1610, 29.1224, 98.7953],\n\t\t\t\t[44.7469, 116.2866, 46.4130, 119.9547],\n\t\t\t\t[22.1509, 99.4518, 22.8888, 101.5251],\n\t\t\t\t[41.5609, 106.4521, 42.1729, 112.0338],\n\t\t\t\t[40.8870, 124.1700, 41.5679, 125.9757],\n\t\t\t\t[49.4970, 119.3816, 50.6762, 120.8089],\n\t\t\t\t[49.3316, 125.4225, 51.2651, 126.9184],\n\t\t\t\t[37.1464, 75.1441, 38.6352, 76.8756],\n\t\t\t\t[41.4833, 127.1282, 42.0490, 128.0580],\n\t\t\t\t[45.8638, 133.1031, 48.0605, 133.6508],\n\t\t\t\t[47.4507, 133.6275, 48.3165, 134.5299],\n\t\t\t\t[32.3204, 120.8063, 36.6148, 125.2434],\n\t\t\t\t[28.0898, 122.1926, 32.4149, 129.4044],\n\t\t\t\t[25.2971, 120.8675, 28.2165, 126.5996],\n\t\t\t\t[21.1021, 118.0693, 25.3132, 122.3802],\n\t\t\t\t[14.0561, 112.4204, 22.5872, 119.5878],\n\t\t\t\t[19.6497, 119.4778, 21.1806, 121.0020],\n\t\t\t\t[9.7891, 109.6162, 15.5257, 118.1505],\n\t\t\t\t[5.6145, 106.8594, 9.8540, 115.3392],\n\t\t\t\t[4.2167, 108.2902, 5.6612, 112.5326],\n\t\t\t\t[12.6250, 118.0910, 14.1308, 119.5515],\n\t\t\t\t[2.7992, 109.6809, 4.2559, 111.1337],\n\t\t\t\t[7.0220, 115.3165, 9.8518, 116.7427],\n\t\t\t\t[18.2459, 106.8169, 19.7338, 108.3471],\n\t\t\t\t[36.5488, 123.7356, 40.6430, 125.8812],\n\t\t\t\t[19.6980, 107.9469, 21.5553, 108.3115],\n\t\t\t\t[4.1736, 103.9404, 7.1033, 106.9522],\n\t\t\t\t[6.9882, 105.4241, 8.5050, 106.8956]\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t"minLevel": 9,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 THTC",\n\t\t\t"alt": "copyright 2013 Iran Maps provided by THTC",\n\t\t\t"boxes": [\n\t\t\t\t[29.8960, 48.0337, 36.6154, 60.4761],\n\t\t\t\t[35.7922, 45.2450, 38.9187, 53.8126],\n\t\t\t\t[32.4091, 45.6075, 35.8327, 48.0570],\n\t\t\t\t[26.4373, 52.5746, 29.9127, 62.9038],\n\t\t\t\t[29.8613, 60.4731, 31.4985, 61.8767],\n\t\t\t\t[31.4630, 60.4320, 36.6154, 60.9466],\n\t\t\t\t[30.8911, 47.4205, 32.4190, 48.0706],\n\t\t\t\t[24.9641, 57.0085, 26.4565, 62.2974],\n\t\t\t\t[26.6229, 62.8963, 27.2549, 63.3307],\n\t\t\t\t[34.5901, 60.9157, 36.6464, 61.3015],\n\t\t\t\t[36.5729, 53.7891, 37.6781, 60.3488],\n\t\t\t\t[37.6386, 54.8182, 38.2889, 58.2282],\n\t\t\t\t[38.9000, 46.6111, 39.7085, 48.3898],\n\t\t\t\t[36.4006, 44.0295, 39.7794, 46.0038],\n\t\t\t\t[33.7685, 45.4011, 34.6038, 45.6497],\n\t\t\t\t[27.5226, 50.1860, 29.9188, 52.6222]\n\t\t\t]\n\t\t}\n\t],\n\t"satellite": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 Nokia",\n\t\t\t"alt": "copyright 2013 Nokia All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 DigitalGlobe",\n\t\t\t"alt": "copyright 2013 DigitalGlobe, Inc."\n\t\t}\n\t],\n\t"hybrid": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 Nokia",\n\t\t\t"alt": "copyright 2013 Nokia All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label":"2013 DigitalGlobe",\n\t\t\t"alt": "copyright 2013 DigitalGlobe All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 4,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 INEGI",\n\t\t\t"alt": "copyright 2013 INEGI All Rights Reserved",\n\t\t\t"boxes": [\n\t\t\t\t[14.5333, -118.3666, 32.7166, -86.7]\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t"minLevel": 9,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 NavInfo",\n\t\t\t"alt": "copyright 2013 NavInfo Co Ltd. All Rights Reserved",\n\t\t\t"boxes": [\n\t\t\t\t[29.1171, 84.2005, 41.5657, 124.1865],\n\t\t\t\t[41.5630, 85.7494, 47.1087, 90.6305],\n\t\t\t\t[41.5601, 90.6025, 42.5667, 101.8172],\n\t\t\t\t[42.5506, 90.6234, 44.2497, 95.3195],\n\t\t\t\t[30.4401, 80.8031, 45.1197, 85.7610],\n\t\t\t\t[23.3901, 98.7867, 29.1184, 120.0226],\n\t\t\t\t[26.3574, 120.0168, 29.1201, 122.1214],\n\t\t\t\t[41.5652, 112.0222, 44.7488, 126.5498],\n\t\t\t\t[44.7472, 119.9286, 49.3447, 129.5186],\n\t\t\t\t[49.3350, 120.7819, 53.0810, 125.4870],\n\t\t\t\t[43.0083, 126.5408, 47.7089, 130.9583],\n\t\t\t\t[45.3400, 130.9452, 47.6509, 133.1190],\n\t\t\t\t[36.0000, 76.8533, 40.9910, 80.8040],\n\t\t\t\t[48.0400, 116.5004, 49.5037, 120.7834],\n\t\t\t\t[18.1302, 108.0738, 23.4047, 117.3293],\n\t\t\t\t[22.8489, 99.5674, 23.4100, 104.7658],\n\t\t\t\t[28.3256, 85.1978, 29.1306, 92.9427],\n\t\t\t\t[38.5986, 74.5747, 40.2635, 76.8557],\n\t\t\t\t[30.9888, 79.6755, 34.1592, 80.8057],\n\t\t\t\t[45.1121, 82.8615, 46.8092, 85.7618],\n\t\t\t\t[47.1043, 85.7107, 48.3877, 88.5712],\n\t\t\t\t[44.2477, 90.6263, 44.9384, 93.5556],\n\t\t\t\t[21.9867, 106.8269, 23.4067, 108.0747],\n\t\t\t\t[42.0392, 126.5396, 43.0312, 129.2131],\n\t\t\t\t[28.0162, 96.1699, 29.1244, 97.3297],\n\t\t\t\t[27.6988, 98.1610, 29.1224, 98.7953],\n\t\t\t\t[44.7469, 116.2866, 46.4130, 119.9547],\n\t\t\t\t[22.1509, 99.4518, 22.8888, 101.5251],\n\t\t\t\t[41.5609, 106.4521, 42.1729, 112.0338],\n\t\t\t\t[40.8870, 124.1700, 41.5679, 125.9757],\n\t\t\t\t[49.4970, 119.3816, 50.6762, 120.8089],\n\t\t\t\t[49.3316, 125.4225, 51.2651, 126.9184],\n\t\t\t\t[37.1464, 75.1441, 38.6352, 76.8756],\n\t\t\t\t[41.4833, 127.1282, 42.0490, 128.0580],\n\t\t\t\t[45.8638, 133.1031, 48.0605, 133.6508],\n\t\t\t\t[47.4507, 133.6275, 48.3165, 134.5299],\n\t\t\t\t[32.3204, 120.8063, 36.6148, 125.2434],\n\t\t\t\t[28.0898, 122.1926, 32.4149, 129.4044],\n\t\t\t\t[25.2971, 120.8675, 28.2165, 126.5996],\n\t\t\t\t[21.1021, 118.0693, 25.3132, 122.3802],\n\t\t\t\t[14.0561, 112.4204, 22.5872, 119.5878],\n\t\t\t\t[19.6497, 119.4778, 21.1806, 121.0020],\n\t\t\t\t[9.7891, 109.6162, 15.5257, 118.1505],\n\t\t\t\t[5.6145, 106.8594, 9.8540, 115.3392],\n\t\t\t\t[4.2167, 108.2902, 5.6612, 112.5326],\n\t\t\t\t[12.6250, 118.0910, 14.1308, 119.5515],\n\t\t\t\t[2.7992, 109.6809, 4.2559, 111.1337],\n\t\t\t\t[7.0220, 115.3165, 9.8518, 116.7427],\n\t\t\t\t[18.2459, 106.8169, 19.7338, 108.3471],\n\t\t\t\t[36.5488, 123.7356, 40.6430, 125.8812],\n\t\t\t\t[19.6980, 107.9469, 21.5553, 108.3115],\n\t\t\t\t[4.1736, 103.9404, 7.1033, 106.9522],\n\t\t\t\t[6.9882, 105.4241, 8.5050, 106.8956]\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t"minLevel": 9,\n\t\t\t"maxLevel": 20,\n\t\t\t"label":"2013 THTC",\n\t\t\t"alt": "copyright 2013 Iran Maps provided by THTC",\n\t\t\t"boxes": [\n\t\t\t\t[29.8960, 48.0337, 36.6154, 60.4761],\n\t\t\t\t[35.7922, 45.2450, 38.9187, 53.8126],\n\t\t\t\t[32.4091, 45.6075, 35.8327, 48.0570],\n\t\t\t\t[26.4373, 52.5746, 29.9127, 62.9038],\n\t\t\t\t[29.8613, 60.4731, 31.4985, 61.8767],\n\t\t\t\t[31.4630, 60.4320, 36.6154, 60.9466],\n\t\t\t\t[30.8911, 47.4205, 32.4190, 48.0706],\n\t\t\t\t[24.9641, 57.0085, 26.4565, 62.2974],\n\t\t\t\t[26.6229, 62.8963, 27.2549, 63.3307],\n\t\t\t\t[34.5901, 60.9157, 36.6464, 61.3015],\n\t\t\t\t[36.5729, 53.7891, 37.6781, 60.3488],\n\t\t\t\t[37.6386, 54.8182, 38.2889, 58.2282],\n\t\t\t\t[38.9000, 46.6111, 39.7085, 48.3898],\n\t\t\t\t[36.4006, 44.0295, 39.7794, 46.0038],\n\t\t\t\t[33.7685, 45.4011, 34.6038, 45.6497],\n\t\t\t\t[27.5226, 50.1860, 29.9188, 52.6222]\n\t\t\t]\n\t\t}\n\t],\n\t"terrain": [\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 Nokia",\n\t\t\t"alt": "copyright 2013 Nokia All Rights Reserved"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 0,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "SRTM V4, 2013, CIAT",\n\t\t\t"alt": "SRTM V4, 2013, CIAT"\n\t\t},\n\t\t{\n\t\t\t"minLevel": 4,\n\t\t\t"maxLevel": 20,\n\t\t\t"label": "2013 INEGI",\n\t\t\t"alt": "copyright 2013 INEGI All Rights Reserved",\n\t\t\t"boxes": [\n\t\t\t\t[14.5333, -118.3666, 32.7166, -86.7]\n\t\t\t]\n\t\t}\n\t]\n}';
(function(){function d(a,b){h(b,function(b,c){e[b]||(e[b]={});a[b]||(a[b]=[]);e[b][c.label]||a[b].unshift(c)})}function k(b,e){var c=e.boxes,d,g;if(c instanceof Array)for(d=c.length;d--;)g=c[d],c[d]=new a([g[2],g[1]],[g[0],g[3]],!0)}function h(a,b){var e,c;for(e in a)if(a.hasOwnProperty(e))for(c=a[e].length;c--;)b(e,a[e][c])}var c=nokia.maps,b=c.Config,g=c.net.Request,a=c.geo.BoundingBox,e={},l=c.resources.copyrights=eval("("+nokia.maps.resources.copyrights.json+")"),c=new ovi.Class({Extends:c.util.OObject,
initialize:function(){h(l,k);this.set("copyrights",l);this.onCopyrightLoaded=ovi.bind(this,this.onCopyrightLoaded);this.Ro=!1},loadCopyright:function(){var a,e=b.getDefault("secureConnection");if(!this.Ro)a=new g(g.JSONP,{callbackKey:"callback_func",standardJSONP:!0}),a.send("http"+(e==="force"||e==="prefer"?"s":"")+"://maps.nlp.nokia.com/maptile/2.1/copyright/newest",this.onCopyrightLoaded),this.Ro=!0},onCopyrightLoaded:function(a){!a.error&&a.response&&(a=ovi.json.parse(a.response),e={},h(a,function(a,
b){var f=b.alt;b.label=b.label.replace(/2012/g,"2013").replace(/\s&.+/g,"");b.alt=f.replace(/2012/g,"2013").replace(/\s&.+/g,"");k(0,b);e[a]||(e[a]={});e[a][b.label]=!0}),d(a,l),this.set("copyrights",a))},get:function(a,b,e){var c=[],d,g,l,h,k;if(a=this.copyrights[a])for(l=a.length;l--;)if(d=a[l],e>=d.minLevel&&e<=d.maxLevel){if(g=d.boxes){k=0;for(h=g.length;h--;)if(g[h].intersects(b)){k=1;break}}else k=1;k&&c.unshift({label:d.label,alt:d.alt})}return c}});nokia.maps.map.js.copyrights=new c})();ovi.provide("nokia.maps.map._MarkerIcon");
(function(){function d(a){if(typeof a==="object"&&a.strokeColor)a.strokeColor=c.ColorHelper.getHex3(a.strokeColor);if(a instanceof g)return a;else if(typeof a==="object")return new g(a);return new g({strokeColor:c.ColorHelper.getHex3(a)})}var k=nokia.maps,h=k.map.HitArea,c=k.util,b=c.Point,g=c.Pen,a=c.Brush,e=k.gfx.GraphicsImage,l=new k.gfx.SvgParser,f=c.uc("shape text textPen pen brush effect"),p=c.flatMerge(c.uc("anchor hitArea"),f),m=nokia.maps.map.jb=new ovi.Class({Extends:nokia.maps.util.OObject,
initialize:function(a){var b;a&&"shape"in a?(this.shape=this.shapeSetter(b=a.shape),delete a.shape,this._super(a),a.shape=b):(this.shape=this.shapeSetter(this.shape),this._super(a));this.addObserver("*",this.yd)},Statics:{hm:p,Da:function(a){return a in p},Kd:function(a){return!(a in f)},Gb:{balloon:['<path style="opacity:0.4;fill:#353535" d="m 68.999,117 c 0,1.668 -2.687,3 -6.001,3 c -3.312,0 -5.999,-1.332 -5.999,-3 c 0,-1.666 2.688,-3 5.999,-3 c 3.314,0 6.001,1.334 6.001,3 z" transform="translate(-50,-86)"/><path style="fill:__PEN__" d="m 106,-21 c -3.472,0 -6.7335,1.325 -9.1875,3.75 C 94.3585,-14.824 93,-11.58625 93,-8.15625 c 0,3.432 1.3585,6.6385 3.8125,9.0625 L 106,10 l 9.1875,-9.09375 c 2.455,-2.426 3.8125,-5.6325 3.8125,-9.0625 c 0,-3.428 -1.3575,-6.66575 -3.8125,-9.09375 C 112.7325,-19.675 109.474,-21 106,-21 z" transform="translate(-93,21)"/><path style="fill:#ffffff" d="m 106,-20 c -3.207,0 -6.234,1.22975 -8.5,3.46875 c -2.264,2.237 -3.5,5.217 -3.5,8.375 c 0,3.16 1.236,6.139 3.5,8.375 l 8.5,8.375 l 8.5,-8.375 c 2.264,-2.236 3.5,-5.215 3.5,-8.375 c 0,-3.158 -1.236,-6.137 -3.5,-8.375 C 112.233,-18.77025 109.209,-20 106,-20 z" transform="translate(-93,21)"/><path style="fill:__BRUSH__;fill-opacity:1" d="m 62.998,88.1875 c -6.984391,0 -10.738298,4.963982 -10.8105,10.6525 c 0,3.268 0.9535,5.611 3.0255,7.658 l 7.785,7.691 l 7.789,-7.691 c 2.072,-2.047 3.0255,-4.268 3.0255,-7.658 C 73.584296,93.067975 69.982391,88.1875 62.998,88.1875 z" transform="translate(-50,-86)"/><text x="13" y="18" font-size="10pt" font-family="arial" font-weight="bold" text-anchor="middle" fill="__TEXTPEN__" textContent = "__TEXTCONTENT__">__TEXT__</text>',
28,36,13,31,"poly",[0,16,0,7,8,0,18,0,26,7,26,16,18,34,8,34]]}},text:"",pen:new g({strokeColor:"#FFF"}),textPen:new g({strokeColor:"#FFF"}),brush:new a({color:"#1080DD"}),shape:"balloon",effect:"none",yd:function(a,b){if(b in f)a.za=0},shapeSetter:function(a){var e=this.Gm=m.Gb[a]||c.c("shape");this.o=new b(e[1],e[2]);this.anchor=new b(e[3],e[4]);this.hitArea=e[5]?new h(e[5],e[6]):void 0;return a},brushSetter:function(b){if(typeof b==="object"&&b.color)b.color=c.ColorHelper.getHex3(b.color);if(b instanceof
a)return b;else if(typeof b==="object")return new a(b);return new a({color:c.ColorHelper.getHex3(b)})},penSetter:d,textPenSetter:d,textSetter:function(a){return c.sanitizeText(a)},getIcon:function(){if(this.za)return this.za;var a=m.Gb[this.shape],b=a[1],f=a[2];return this.za=new e(l.parseSvg('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+b+'" height="'+f+'" viewBox="0 0 '+b+" "+f+'">'+a[0].replace("__TEXTCONTENT__",this.text).replace("__TEXT__",this.text).replace("__TEXTPEN__",this.textPen.strokeColor).replace("__PEN__",
this.pen.strokeColor).replace("__BRUSH__",this.brush.color)+"</svg>"))}})})();ovi.provide("nokia.maps.map.overlay.ObjectTileProvider");
nokia.maps.map.overlay.ObjectTileProvider=new ovi.Class({Extends:nokia.maps.map.overlay.ObjectProvider,initialize:function(d){var k;this._super(d);this.di={};this.Cv=new nokia.maps.geo.QuadTree(this.max-this.min+1);this.dv={};this.Db=0;d=1<<this.max;k=this.tileSize;this.gm=new nokia.maps.geo.PixelProjection(nokia.maps.geo.mercator,k*d,k*d)},max:18,tileSize:256,request:function(d,k){this.Db++;d>this.max||d<this.min?this.notify([]):this.eu(d,k)},cache:function(d){this.di[d.Nu]=d},getCachedTile:function(d,
k,h){return this.di[this.ko(d,k,h)]},objectTileArrived:function(d,k,h,c,b,g){g?(k=this.ko(k,h,c),d.Nu=k,b==this.Db?this.finishRequest(d,!0):this.cache(d)):this.finishRequest([],!1)},ts:function(d,k){var h=this.max,c=this.tileSize,b=this.gm,g=b.geoToPixel(k.topLeft),b=b.geoToPixel(k.bottomRight);return[g.y/c>>h-d,g.x/c>>h-d,b.y/c>>h-d,b.x/c>>h-d]},eu:function(d,k){for(var h=this.ts(d,k),c=h[1],b=h[2],g=h[3],a,h=h[0];h<b+1;h++)for(a=c;a<g+1;a++)this.requestTile(this.Db,d,h,a)},ko:function(d,k,h){for(var c=
[];d--;)mask=1<<d,c.push(((h&mask)!==0)+((k&mask)!==0)*2);return c.join("")}});ovi.provide("nokia.maps.map.Object");
(function(d){if(!d.util.getConstructor(d.map.Object)){var k=0,h=0,c=function(b,a){var e=b.ya(),c=a.ya(),f,d,m,k=0,q;if(!e||!c)return 0;f=e.length;d=c.length;for(m=f<d?f:d;k<m;k++)if(q=c[k]-e[k])return h?-q:q;return h?f-d:d-f},b={rev:0,sort:function(b,a,e){var d=[],f,k,m=b.length;for(k=0;k<m;k++)((f=b[k]).getIconForRendering||f.drawToTile)&&(a||f.isVisible())&&d.push(f);h=e;d.sort(c);return d},create:function(b){var a=b.f,e;e=null;a&&(e=(e=a.ya())?e.slice():[],e.push(b.zIndex,a.objects.indexOf(b)));
return e}};nokia.maps.map.Object=new ovi.Class({Extends:d.util.OObject,Mixins:d.dom.EventTarget,Statics:{sortByZInfo:b.sort,CHANGE_SPATIAL:1,CHANGE_VISUAL:2,CHANGE_ZINDEX:4},initialize:function(b){this.k=new d.map.provider.NullObjectProvider;this.id=k++;this._super(b);this.addObserver("*",this.Ab,this)},f:null,CHANGE_SPATIAL:1,CHANGE_VISUAL:2,CHANGE_ZINDEX:4,isEventTarget:!0,zIndex:0,visibility:!0,s:"object",Wc:function(){return this.qb||(this.qb={})},destroy:function(){var b=this.f;b&&b.objects.remove(this);
this.removeAllListeners();this.k=null;this.removeObserver("*",this.Ab,this)},getInvalidations:function(b){var a=this.qb;return a?(a[1]>b)*1|(a[2]>b)*2|(a[4]>b)*4:0},Ab:function(b,a){this.Y(a,0)},getProvider:function(){return this.k},getParent:function(){return this.f},getRoot:function(){for(var b=this,a=null;b=b.f;)a=b;return a},getDisplay:function(){var b=this.getRoot();return b&&b.s==="display"?b:null},isVisible:function(){var b=this,a=!1;do a=b.visibility;while(a&&(b=b.f));return a},Y:function(b,
a){var e;e=this.k;var c;a|=b==="zIndex"?4:b==="visibility"?2:0;c=e.mc(this,a);e=this.Wc();a&1&&(e[1]=c);a&2&&(e[2]=c);a&4&&(e[4]=c)},zIndexSetter:function(b){this.rb();return b},eventListenerSetter:function(b){var a=0,e,c;if(b)for(c in this.removeAllListeners(),b)if((a=ovi.type(e=b[c]))==="array")for(a=0;a<e.length;a+=3)this.addListenerNS(e[a+2],c,e[a],e[a+1]);else a==="function"&&this.addListenerNS(null,c,e,!1)},ya:function(){var c;if(!(c=this.Nb))c=this.Nb=b.create(this);return c},rb:function(){this.Nb=
void 0},adopt:function(b){return b.adopt(this)},orphan:function(){return this.k.orphan(this)}})}})(nokia.maps);ovi.provide("nokia.maps.map.Spatial");nokia.maps.map.Spatial=new ovi.Class({Extends:nokia.maps.map.Object,initialize:function(d){this._super(d);this.Xl={}},simplify:3,oc:1});ovi.provide("nokia.maps.map.render.p2d.dom.SpatialTileLayer");
(function(d){function k(a,b,d){var g=this.k,l=c(2,this.mm+8);a*=l;var b=b*l/this.vh.x*this.vh.y,l=g.getTileId(this.mm,a,b),k,s;if(l&&(k=this.Bc[l])&&(k=k[0]))s=e(k.Oc.Qb(a%g.width,b%g.height,d),!1,!1);return s||h}var h=[],c=Math.pow,b=d.map,g=d.dom,a=d.css,e=b.Object.sortByZInfo,l=b.render.p2d.dom.TileLayer;nokia.maps.map.render.p2d.dom.SpatialTileLayer=function(b,e,c,d){var e=new l(b,e,c,d),h;e.Qb=k;e.Jv=null;b.className=e.pv=c.cssClass+"SpatialTileLayer";e.iq=function(a,b,e){a=new nokia.maps.util.Point(a/
e.Oc.k.tileSize.x,b/e.Oc.k.tileSize.y);this.Rd.setScale(e.Tb,a)};e.jq=function(b,e){a.transformType>0&&e!==1&&g.fd(b,e)};h=e.render;e.render=function(){this.k.ad();h.apply(this,arguments)};e.Mn=function(a,b){b||(b={d:a.d});b.qc=a.qc;b.Tb=(b.Oc=a.Oc).getNode(this.B);return b};return e}})(nokia.maps);ovi.provide("nokia.maps.map._Copyright");ovi.provide("nokia.maps.resources.copyright.html");nokia.maps.resources.copyright.html='<div class="nm_crimg" style="display:block;position:absolute;bottom:20px;left:4px;width:33px;height:24px;margin:6px;cursor:pointer" title="HERE"></div> \r\n<div class="nm_crnode" style="position:relative;top:0;padding-left:10px;padding-bottom:8px;height:13px;font-size:10px;font-family:arial, sans-serif;color:#333;white-space:nowrap;"> \r\n\t<span class="nm_crtext"></span>&nbsp;<a class="nm_toulink" target="_blank" style="text-decoration: underline;"></a>\r\n\t&nbsp;<a class="nm_rilink" target="_blank" title="" style="text-decoration: none;"></a>\r\n</div>';
(function(d){function k(a){e.test(a)||d.util.c("alignment '"+a+"'");this.Qr.hn(a);return a}var h=d.dom,c=Math.floor,b=d.util,g=new d.language.Manager,a=b.Point,e=/^(top|middle|bottom)(left|center|right)$/,l;d.map.vn=new ovi.Class({initialize:function(a){var e,c;this.W=a;l=ovi.Array([a.SATELLITE,a.SATELLITE_PLAIN,a.SATELLITE_COMMUNITY,a.GLOBE,a.PANORAMA]);e=this.Rr=h.Qa(a.ji,"div");e.innerHTML=d.resources.copyright.html;this.Zm=h.findElement("nm_toulink",e);c=this.Dj=h.findElement("nm_rilink",e);c.onclick=
function(){var b=a.m.getCam(),e="http://here.com/latitude,longitude,fov,yaw,pitch,panorama.day,report",c;for(c in b)e=e.replace(RegExp("\\b"+c+"\\b"),b[c]);this.href=e};c.onclick();this.yq=(this.Ju=h.findElement("nm_crtext",e)).parentNode;(c=(this.ea=e=h.findElement("nm_crimg",e)).style).backgroundRepeat="no-repeat";c.backgroundImage="url("+d.loadPath+d.config.assetsPath+"/here_logo.png)";e.onclick=function(){var b=a.center;window.open(["http://maps.nokia.com/?cid=nokiamaps-fw-ilc-na-acq-na-thirdparty-g0-na-1#",
b.latitude,b.longitude,a.zoomLevel,"0|0|"].join("|"))};a.ed("poweredByWidth",e.offsetWidth);a.ed("poweredByHeight",e.offsetHeight);this.Yd=ovi.bind(this,this.Yd);a.copyrightAlignmentSetter=k;a.addListener("basemapchangeend",this.Yd);a.addListener("mapviewchangeend",this.Yd);a.addListener("resizeend",this.Yd);d.map.js.copyrights.addObserver("copyrights",this.Yd);this.hn(a.copyrightAlignment);this.Yd();this.lp();b.getRootNameSpace("nokia.maps").Settings.addObserver("defaultLanguage",this.lp,this)},
lp:function(){var a;a=this.Zm;a.title=a.innerHTML=g.translateToken("ovi.service.map._t66",!1);a.href=h.Page.browser.mobile?"http://nokia.mobi/terms":g.translateToken("ovi.service.map._t67",!1);a=this.Dj;a.title=a.innerHTML=g.translateToken("ovi.service.map._t94",!1)},hn:function(b){var d=this.W,g=this.Rr,l=this.yq,h=this.ea;if(b){var k=e.exec(b),b=k[1],k=k[2],s=g.style;s.cssText="position:absolute;z-index:500;"+(b==="middle"?"top:50%;margin-top:"+c(g.offsetHeight/-2)+"px;":b+":"+(b==="top"?"34px;":
"-7px;"))+(k==="center"?"left:50%;margin-left:"+c(g.offsetWidth/-2)+"px;":k+":"+(k==="left"?"-4px;":"4px;"))+"width:"+s.width+";height:"+s.height+";"}if(g.style.bottom&&ovi.dom.hasClass(d.P.parentNode,"nm_adbar_bottom"))g.style.bottom="21px";g=new a(g.offsetLeft,g.offsetTop);d.ed("copyrightPosition",g.add({x:l.offsetLeft,y:l.offsetTop}));d.ed("poweredByPosition",g.add({x:h.offsetLeft,y:h.offsetTop}))},Yd:function(){var a=this.W,b=this.yq,e=a.baseMapType;this.Ju.innerHTML="&copy; "+a.getCopyright();
l.indexOf(e)===-1?(b.style.color=this.Zm.style.color=this.Dj.style.color="#333",this.ea.style.backgroundPosition="0 0"):(b.style.color=this.Zm.style.color=this.Dj.style.color="#FFF",this.ea.style.backgroundPosition="0px -34px");this.Dj.style.display=e===a.PANORAMA?"":"none";this.hn();a.ed("copyrightWidth",b.offsetWidth);a.ed("copyrightHeight",b.offsetHeight)}})})(nokia.maps);ovi.provide("nokia.maps.map.Marker");
(function(){var d=nokia.maps,k=d.util,h=d.dom,c=d.map,b=d.gfx,g=k.Point,a=k.Strip,e=new g(0,0),l=k.Rectangle,f=c.jb,p=d.geo,m=c.HitArea,r=p.Coordinate,d=new ovi.Class({Extends:c.Object,initialize:function(a,b){var e;if(this.s==="marker"&&(!b||!("icon"in b)))e=new f,this.set("icon",e.getIcon()),this.set("anchor",e.anchor),this.set("hitArea",e.hitArea);this.Aa={};this._super(b);this.set("coordinate",a,1)},s:"marker",anchor:e,o:e,coordinateSetter:function(a){(a=r.fromObject(a))||k.c();this.Aa={};return a},
hitAreaSetter:function(a){return!a?a:m.from(a)},anchorSetter:function(a){(a=g.fromObject(a))||k.c("you have to set util.Point");return a},ua:function(a){this.o=new g(a.width,a.height);this.Hb=1},iconSetter:function(a){ovi.type(a);a instanceof b.Image||(a=b.Image.fromObject(a));a instanceof b.Image||k.c("icon");this.icon=a.B===document?a:a.clone(document);a.state===1?this.ua(a):this.Hb=0;return this.icon},getBoundingBox:function(){return p.BoundingBox.coverAll([this.coordinate])},getDisplayBoundingBox:function(a){a=
a.geoToPixel(this.coordinate).sub(this.anchor);return new l([a,a.add(this.o)])},hitTest:function(a,b,e,c){var a=this.getDisplayBoundingBox(a),f=new g(b,e),d=this.hitArea;return a.contains(f)&&(!d||d.hitTest(b-a.topLeft.x,e-a.topLeft.y,c))},getDisplayOffset:function(a,b,e){return(new g(b,e)).sub(a.geoToPixel(this.coordinate))},Y:function(a,b){a!=="zIndex"&&(b|=a==="coordinate"?1:2);this._super(a,b)},zd:function(a){var b="error";a.state===1&&(this.ua(a),this.Y("icon",2),b="load");this.dispatch(new h.Event({type:b,
target:this,relatedTarget:a}))},getIconForRendering:function(a){var b=this.icon;a!==document&&(b=b.clone(a));b.state?this.Hb||b.state===1&&this.ua(b):b.prepare(this.zd,this);return b},project:function(b){return this.Aa[b.id]||(this.Aa[b.id]=b.geoToMapPoints(a.stencil(a.LAT_LNG,[this.coordinate.latitude,this.coordinate.longitude])))}});if(c.Marker.isNs)c.Marker=d})();ovi.provide("nokia.maps.map.StandardMarker");
(function(){function d(b,c,a){b.R.set(c,a);if(c==="shape")b.o=b.R.o,b.set("anchor",b.R.anchor),b.set("hitArea",b.R.hitArea);return b.R[c]}var k=nokia.maps,h=k.util,c=k.map.jb,k=nokia.maps.map.StandardMarker=new ovi.Class({Extends:nokia.maps.map.Marker,initialize:function(b,d){var a=this.R=new c(h.flatMerge({},d,1,c.Da));h.flatMerge(this,a,1,c.Da);this.o=a.o;this._super(b,h.flatMerge({},d,1,c.Kd))},s:"standardmarker",shapeSetter:function(b){return d(this,"shape",b)},textSetter:function(b){return d(this,
"text",b)},textPenSetter:function(b){return d(this,"textPen",b)},penSetter:function(b){return d(this,"pen",b)},brushSetter:function(b){return d(this,"brush",b)},getIconForRendering:function(b){this.set("icon",this.R.getIcon());return this._super(b)}});h.flatMerge(k.prototype,c.prototype,!0,c.Da)})();ovi.provide("nokia.maps.map.Container");
(function(){var d=nokia.maps.map,k=nokia.maps.util,h=k.c,c=new ovi.Class({Extends:d.Object,initialize:function(b,c){b&&!b.length&&(c=b,b=void 0);var a=this,e=a.objects=new k.OList;e.Ht=e.I;e.I=function(b,c,d){b===a&&h();var g=b.k,k=b.f;k&&k.objects.remove(b);if(b.orphan()&&b.adopt(a.k))return b.rb(),e.Ht(b,c,d);k&&k.objects.add(b);b.k=g;h()};e.It=e.Bb;e.Bb=function(a,b){e.get(a);return this.It(a,b)};e.addObserver(a.Kr,a);a._super(c);b&&e.addAll(b)},s:"container",objectsSetter:function(b){this.objects.clear();
return this.objects.addAll(b)},Kr:function(b,c,a,e){var d=this.k,b=b.X.length;c==="add"?(a.f=this,this.so(a)&&this.Ei(d.zf,a,[]),e!==b-1&&this.kl(e+1)):(this.so(a)&&this.Ei(d.mh,a,[]),a.f=null,a.rb(),e!==b&&this.kl(e))},Ei:function(b,c,a){var e,d;if(this.Ho(c)){c=c.objects;for(d=c.getLength();d--;)e=c.get(d),e=this.Ho(e)?e.Ei(b,e,a):b.apply(this.k,[e].concat(a))}else e=b.apply(this.k,[c].concat(a));return e},Ho:function(b){return b instanceof c},so:function(b){for(var c=this.k.fu;b=b.f;)if(b===c)return!0;
return!1},getBoundingBox:function(){for(var b=this.objects,c=b.getLength(),a,e=null;c--;)if(a=b.get(c).getBoundingBox())e=!e?a:e.merge(a);return e},Y:function(b,c){c|=b==="zIndex"?4:b==="visibility"?2:0;c&&this.Ei(this.k.mc,this,[c])},kl:function(b){for(var c=this.objects.X,a=c.length;b<a;)c[b++].rb()},rb:function(){this._super();this.kl(0)},contains:function(b){for(var c=!1;b&&!(c=b===this);)b=b.f;return c},orphan:function(){for(var b=this.objects,c=b.getLength();c--;)b.get(c).orphan();return this._super()},
adopt:function(b){for(var c=this.objects,a=c.getLength();a--;)c.get(a).adopt(b);return this._super(b)}});if(d.Container.isNs)d.Container=c})();ovi.provide("nokia.maps.map.Polyline");
(function(d){var k=nokia.maps.geo,h=k.BoundingBox,c=k.Coordinate,d=nokia.maps.util,b=d.math.clipping.clipStrips,g=d.isArray,a=d.Strip,e=nokia.maps.util.Rectangle,l=d.Point,f=d.Arrows,p=d.Pen,m=nokia.maps.gfx.Color.parseCss,r=m("#0000"),q=new a(["latitude","longitude","altitude"]),y=k.Shape.wn,s=[],u=Math,w=u.min,v=u.atan,x=u.sqrt,z=u.pow,A=u.floor,B=180/u.PI,D=nokia.maps.map.Polyline=new ovi.Class({Extends:nokia.maps.map.Spatial,initialize:function(a,b){a instanceof k.Strip||g(a)||d.c("Argument coords is not instance of geo.Strip or Array.");
var e=this.path=a instanceof k.Shape?a:new k.Shape(this.closedShape);a instanceof k.Shape?e.$a=this.closedShape:a instanceof k.Strip?e.ho(a):e.splice(0,0,a,"auto");this.ol={};(!b||!b.pen)&&(this.pen=this.penSetter());this._super(b);e.addObserver(this.Lt,this)},destroy:function(){this.path.destroy();this._super()},Statics:{Vh:100,Rq:s},Zh:null,s:"polyline",color:null,stroke:"solid",width:0,lineJoin:null,pen:null,arrows:null,closedShape:!1,Y:function(a,b){a==="path"?(this.Wp(),b|=1):a!=="zIndex"&&(b|=
2);this._super(a,b)},Lt:function(a,b){this.Wp();this.Y(b,1)},Wp:function(){this.Zh=null;this.ol={}},getNearest:function(a){var b=this.path,a=this.getNearestIndex(a);return b.get(a)},getNearestIndex:function(a){for(var b=this.path.asArray(),e=b.length,c=k.Coordinate.fromObject(a),f,d=c.distance({latitude:b[0],longitude:b[1]}),g=0,a=3;a<e;a+=3)f=c.distance({latitude:b[a],longitude:b[a+1]}),f<d&&(g=a/3,d=f);return g},getBoundingBox:function(){var a=this.path,b=this.Zh;if(!b&&(b=a.getBoundingBox()))b.getWidth()==
360&&a.ab%2==1&&(b=b.merge(new h(new c(this.coverNorthPole?90:-90,0,void 0,!0),void 0,!0))),this.Zh=b;return b},pathSetter:function(a){var b=this.path;b.splice(0,b.getLength(),k.Strip.convertToArray(a),"unsafe values lat lng alt");return b},widthSetter:function(a){(a=d.da(a,0,D.Vh))!==a&&d.c("width must be in range [0.."+D.Vh+"]");this.pen=new p({lineWidth:a},this.pen);return a},strokeSetter:function(a){a!=="solid"&&d.c("cannot set anything else than stroke=solid");this.pen=new p({stroke:a},this.pen);
return a},colorSetter:function(a){m(a)===null&&d.c("color");this.pen=new p({strokeColor:a},this.pen);return a},lineJoinSetter:function(a){this.pen=new p({lineJoin:a},this.pen);return a},penSetter:function(a){a instanceof p||(a=new p(a));this.set("width",a.lineWidth);this.set("color",a.strokeColor);this.set("lineJoin",a.lineJoin);return a},arrowsSetter:function(a){return a instanceof f?a:a?new f(a):!1},coveredByTile:function(a,b,e){var c=a?a.length:0,f,d=this.lineWidth;if(this.closedShape)for(;c--;)if(l.isCoveredBy(b,
e,a[c],d,!0)){f=!0;break}return f||!1},drawToTile:function(a,f,d){var g=this.closedShape,k=this.getBoundingBox();h.fromObject([90,k.topLeft.longitude,-90,k.bottomRight.longitude],!0).contains(new c(0,180,void 0,1));var k=this.pen.lineWidth,p=this.pen.lineCap,q=this.pen.lineJoin,z=this.pen.miterLimit,u=d?2*(k>1?k:1)+0.13524:0,u=new e([new l(-u,-u),new l(a.getWidth()+u,a.getHeight()+u)]),f=this.path.clip(f,u,this.simplify,this.coverNorthPole,this.Pk,d,D.Vh),d=f.length,A,u=k||g,v,B,x;if(d){k&&(a.set("strokeColor",
m(this.pen.strokeColor)),a.set("lineWidth",k));p&&a.set("lineCap",p);q&&a.set("lineJoin",q);z&&a.set("miterLimit",z);g&&a.set("fillColor",this.brush.fill==="none"?r:m(this.brush.color));for(this.arrows&&(x=b(f,0,0,v=a.getWidth(),B=a.getHeight()));d--;){p=f[d];z=p.length;A=p[0];if(u){a.beginPath();a.moveTo(A.x,A.y);for(q=1;q<z;q++)a.lineTo((A=p[q]).x,A.y);g&&(a.closePath(),a.fill());k&&a.stroke()}for(q=z;q--;)p.push((A=p[q]).x,A.y);p.splice(0,z)}x&&this.gs(a,v,B,x,k);return!g||!f.fullfilled?f:s}else return f===
y?s:!1},Cs:function(a){for(var b=a.length,e=0;--b;)e+=a[b].distance(a[b-1]);return e},gs:function(a,b,c,f,d){var g=this.arrows,m=d*g.width/2,d=d*g.length/2,h=d/2,k=d*2*g.frequency,p=x(z(d,2)+z(m,2)),b=new e([new l(p,p),new l(b-p,c-p)]),q,r,s,c=this.Cs,y,p=0,u,D,la,M,ia;a.set("fillColor",g.color);for(g=f.length;g--;)if(q=f[g],r=q.length)if((s=c(q))>=k){y=w(A(s/k),1E3);s/=y+1;for(y=s/2;--r;){for(u=(D=q[r]).distance(la=q[r-1]);y<=p+u;)ia=D.x+(la.x-D.x)*(M=(y-p)/u),M=D.y+(la.y-D.y)*M,b.contains(new l(ia,
M))&&(a.save(),a.translate(ia,M),a.rotate(v((-D.y- -la.y)/(D.x-la.x))*B+(D.x<la.x?270:90)),a.beginPath(),a.moveTo(-m,-d),a.lineTo(0,d),a.lineTo(m,-d),a.lineTo(0,-h),a.closePath(),a.fill(),a.restore()),y+=s;p+=u}}},project:function(b){return this.ol[b.id]||(this.ol[b.id]=b.geoToMapPoints(a.stencil(q,this.path.internalArray)))}})})(nokia.maps.util);ovi.provide("nokia.maps.map.provider.LocalObjectProvider");
(function(d){var k=Math,h=d.util,c=h.Event,b=h.c,g=d.geo.QuadTree,a=d.map.Object,e=a.sortByZInfo,l=a.CHANGE_SPATIAL,f=a.CHANGE_VISUAL,p=a.CHANGE_ZINDEX,m=d.map.provider.LocalObjectProvider=new ovi.Class({Extends:d.map.provider.Provider,Statics:{SPATIAL:1,MARKER:2},initialize:function(a,b){this.rl=new g(18);this.Im=new g(18);this.fu=a.k.orphan(a)&&this.adopt(a);this._super(b)},Fo:-k.pow(2,53),Eo:-k.pow(2,53),fi:function(a){return a?++this.Fo:++this.Eo},getInvalidationMark:function(a){return a?this.Fo:
this.Eo},cn:function(){this.dispatch(new c("update"))},yn:function(a){var b,e=a.Wc();b=a.oc?this.Im.insertBoundingBox(a.getBoundingBox()):this.rl.insertCoordinate(a.coordinate);b.Vo=a;a.Lh=b;e[l]=e[f]=e[p]=this.fi(a.oc);return a},Rp:function(a){a.oc?this.Im.remove(a.Lh):this.rl.remove(a.Lh);a.Lh=null;return a},mh:function(a){a.k!==this&&b();if(!a.Lh)return this.getInvalidationMark(a.oc);this.Rp(a);this.update();this.Vn(a);return this.fi(a.oc)},zf:function(a){a.k!==this&&b();this.yn(a);this.update();
return this.fi(a.oc)},mc:function(a,e){a.k!==this&&b();if(!a.Lh)return this.getInvalidationMark(a.oc);e&l&&(this.Rp(a),this.yn(a));this.Vn(a);this.update();return this.fi(a.oc)},Vn:function(a){var b,e;if(a.oc)for(e in b=a.Xl,b)b[e].Wn(a)},getInvalidations:function(a,b){return a.getInvalidations(b)},requestBBox:function(a,b){var c,f,d=[],b=b||m.SPATIAL|m.MARKER;if(b&m.SPATIAL){c=this.Im.intersectBoundingBox(a,1);for(f=c.length;f--;)d.push(c[f].Vo)}if(b&m.MARKER){c=this.rl.intersectBoundingBox(a,1);
for(f=c.length;f--;)d.push(c[f].Vo)}return d=e(d)},cancelBBoxRequest:function(){},adopt:function(b){if(b.k||!(b instanceof a))return!1;b.k=this;return b},orphan:function(b){if(b.k!==this||!(b instanceof a))return!1;b.k=null;return b}})})(nokia.maps);ovi.provide("nokia.maps.map.Polygon");
(function(){var d=nokia.maps.util.Brush,k=nokia.maps.util.c;nokia.maps.map.Polygon=new ovi.Class({Extends:nokia.maps.map.Polyline,initialize:function(d,c){(!c||!c.brush)&&(this.brush=this.brushSetter());this._super(d,c)},s:"polygon",fillColor:null,brush:null,closedShape:!0,coverNorthPole:!1,Pk:136,fillColorSetter:function(h){var c=nokia.maps.gfx.Color,b=c.parseCss(h);b===null&&k("Invalid fillColor set!");this.Pk=c.alpha(b);this.brush=new d({color:h},this.brush);return h},brushSetter:function(h){var c=
nokia.maps.gfx.Color,b;h instanceof d||(h=new d(h));this.set("fillColor",h.color);b=c.parseCss(h.color);this.Pk=c.alpha(b);return h},coverNorthPoleSetter:function(d){return!!d}})})();ovi.provide("nokia.maps.map.Rectangle");
(function(){var d=nokia.maps,k=d.util,d=d.geo,h=d.Strip,c=d.BoundingBox;nokia.maps.map.Rectangle=new ovi.Class({Extends:nokia.maps.map.Polygon,initialize:function(b,c){b=this.boundingBoxSetter(b,1);this._super(this.Tf(this.boundingBox=b),c)},simplify:0,s:"rectangle",Tf:function(b){var c=b.topLeft,a=c.latitude,e=c.longitude,d=b.bottomRight,c=d.latitude,d=d.longitude,e=[a,e,a,d,c,d,c,e],d=0;if(b.getWidth()>=180)b=b.getCenter(),d=b.longitude,e.splice(6,0,c,d),e.splice(2,0,a,d);return new h(e,"unsafe values lat lng")},
boundingBoxSetter:function(b,d){b=c.fromObject(b)||k.c();d||this.set("path",this.Tf(b));return b}})})();ovi.provide("nokia.maps.map.provider.SpatialTile");
(function(){var d=nokia.maps,k=d.util.Point,h=d.dom.importNode,c=d.dom.cloneNode,b=d.map,g=b.Polyline.Rq,d=d.gfx,a=d.Graphics,e=d.IDL,l=d.GraphicsImage,f=d.Painter.defaultPainter.isVML,p=[],m=-1/0,r=p.concat,d=b.provider.SpatialTile=function(a,b,e,c){this.id=a;this.k=b;this.ih=e;this.qc=c;this.Yg={};this.Wl={}};ovi.extend(d.prototype=new b.provider.Tile(0,0,0),{em:m,Ph:m,getIDL:function(){var a,b=this.xo;return b&&new e(r.apply([e.opcodes.BEGIN_2D_IMAGE,(a=this.k).width,a.height,""],b))},getNode:function(a){var b=
this.data,e,d;if(!b&&(e=this.getIDL()))this.data=b=(new l(e,null,document)).createElement(),b.style.position="absolute";if(b){if(a&&a!==document)b=h(a,b,1);else if(f||(d=b.parentNode)&&d.nodeType!==11)b=c(b,1);return b}},zr:function(){var a=this.Yg,b;this.ah=null;for(b in a)a.hasOwnProperty(b)&&this.Wn(a[b][0])},Wn:function(a){var b=a.id,e=this.xo,c,f=this.Yg;if(b in f){delete a.Xl[this.id];if((c=f[b][2])&&(c=e.indexOf(c))!==-1)e.splice(c,1),this.data=0,this.Ph=m;delete f[b]}},Np:function(a,b,e){var c=
a.id,f=this.Yg;c in f||(a.Xl[this.id]=this);return f[c]=b?[a,b,e]:[a]},Qb:function(a,b){var e,c=this.Wl,f,d,m,l,h,r,D,E,G;for(d in c)if(c.hasOwnProperty(d)&&(m=(f=c[d])[1])){l=f[0];if(!(h=m===g)){r=l.width||0;for(D=m.length;D--&&!h;)if(G=k.isCoveredBy(a,b,m[D],r,E=l.closedShape),E&&l.brush.fill==="none"&&G==="S"&&(G=!1),G&&E||!E&&(G==="E"||G==="V"))h=1}h&&(e||(e=[]),e.push(l))}return e||p},Ut:function(){var a=this.k,b=a.yg;if(this.em<b)(a=a.zs(this.ih,this.qc)).length?(this.ah=a,this.state=void 0):
(this.ah=null,this.state=!1),this.em=b},paint:function(){var b=0,e=this.ah,c=e.length;if(c){for(var f=this.k,d=this.ih,g=this.qc,m=f.width,f=f.height,l=[],h,k,p=this.Yg,r,G,N,Q=new a;c--;){k=e[c];h=k.id;if(!(r=p[h]))Q.beginImage(m,f),(h=k.drawToTile(Q,d,g))?(r=this.Np(k,h,Q.getIDL().data.slice(4)),N=1):this.Np(k);r&&(G=r[2])&&l.push(G)}this.Ph=this.em;if(N)this.xo=ovi.Array(l),this.data=0;l.length&&(b=1)}this.ah=0;this.Wl={};for(var X in this.Yg)this.Wl[X]=p[X];return this.state=b!==0}}).constructor=
d})();ovi.provide("nokia.maps.map.Circle");
(function(){var d=nokia.maps,k=Math,h=k.asin,c=k.sin,b=k.cos,g=k.abs,a=k.PI,e=a/180,l=180/a,f=d.util,p=d.geo.Coordinate;nokia.maps.map.Circle=new ovi.Class({Extends:nokia.maps.map.Polygon,initialize:function(a,b,e){this._super(this.Tf(this.center=this.centerSetter(a,1),this.radius=this.radiusSetter(b,1),e&&"precision"in e?this.precisionSetter(e.precision,1):this.precision),e)},s:"circle",precision:60,centerSetter:function(a,b){a=p.fromObject(a)||f.c();a.equals(this.center)?a=this.center:b||this.Cm(a,
this.radius,this.precision);return a},radiusSetter:function(a,b){(a=f.da(a,0,1E7))!==a&&f.c("Passed argument is not a number.");b||this.Cm(this.center,a,this.precision);return a},precisionSetter:function(a,b){((a=f.da(a,4,360))!==a||a===Infinity)&&f.c("Passed argument is not a number or is a infinity.");b||this.Cm(this.center,this.radius,a);return a},Cm:function(a,b,e){this.set("path",this.Tf(a,b,e))},Tf:function(a,b,e){var c=270,e=360/e,f=[],a=p.fromObject(a);this.set("coverNorthPole",a.latitude>
0?!0:!1);if(g(a.latitude===90))f=this.Gr(a,b,e,c,630);else for(;c<630;c+=e)f.push(a.walk(c,b,1));this.Zh=null;return f},Gr:function(f,d,g,k,s){d/=6371E3;for(var u=[],f=e*f.latitude,w,v;k<s;k+=g)w=e*k,v=h(c(f)*b(d)+b(f)*c(d)*b(w)),w=(w+a)%(2*a)-a,u.push(new p(v*l,w*l));return u}})})();ovi.provide("nokia.maps.map.provider.TileProvider");
(function(){var d=nokia.maps,k=d.util.Cache,h=k.NEXT,c=k.DONT;new Image;var b=d.map.provider.SpatialTile,g=d.util,a=g.Event,e=g.Point,d=d.geo,l=d.PixelProjection,f=Math.floor;nokia.maps.map.provider.TileProvider=new ovi.Class({Extends:nokia.maps.map.provider.Provider,initialize:function(a){var b,c,f={},d={},g,h,k,v;this._super(a);this.Jb=new e(this.width,this.height);a=this.projection;g=this.width;h=this.height;k=this.max;for(v=this.min;k>=v;)b=1<<k,c=function(a,b){this.y=a*h;this.x=b*g},c.prototype=
new l(a,g*b,h*b),d[k]=new c(0,0),f[k--]=c;this.Vq=f;this.pixelProjections=d;this.tileSize=new e(g,h)},width:256,height:256,opacity:1,alpha:!1,scalable:!0,cache:new k(128,function(a){return a.data?a:h},null,new k(512,function(a){a.data=null;return a instanceof b?a:h},function(a){a&&a.zr()},new k(2048,function(a){return a instanceof b?c:a}))),projection:d.mercator,getInvalidations:function(a,b){var e=this.getInvalidationMark();return(b<e||a.Ph<e)*1},createId:function(a,b,e,c){return c||(e=this.checkAddy(a,
b,e))!==-1?this.id+"_"+a+"_"+b+"_"+e:!1},checkAddy:function(a,b,e){var c=1<<a;return a<this.min||a>this.max||b<0||b>=(c=1<<a)?-1:(e%=c)<0?e+c:e},cancel:function(a){var b=this.$d[a];if(b&&!--b.Bj)return b.state=void 0,this.finishRequest(a,b,!0,!0),b},wr:function(){var a=this.$d,b,e;for(b in a)if((e=a[b])&&e.Bj)e.Bj=1,this.cancel(b)},finishRequest:function(b,e,c,f){var d;!c&&(d=this.cache)&&e.state!==void 0&&d.add(b,e);delete this.$d[b];if(!f)c=new a("response"),c.data=[b,e.state?e:!1],this.dispatch(c)},
request:function(a,b,e,c){var f,d,g=!1;if((e=this.checkAddy(a,b,e))!==-1)if(d=this.$d[f=this.createId(a,b,e,1)])c||(d.Bj++,g=!0);else{if(g=this.cache)if((d=g.get(f))&&this.getInvalidations(d,this.yg)!==0)g.remove(f,!1),d=void 0;!c&&(d===void 0||d.state===!0&&!d.data)?(d=this.create(a,b,e,f,!1),d.state===void 0?(this.$d[f]=d,g=!0):g=d.state&&d):(d&&d.state===!0&&!d.data&&(d=this.create(a,b,e,f,!0)),g=d!==!0&&d&&d.state&&d.data&&d||!1)}return g},getTileAdr:function(a){return new e(f(a.x/this.width),
f(a.y/this.height))},getTileId:function(a,b,e){if((b=this.checkAddy(a,e=f(e/this.height),f(b/this.width)))!==-1)return this.createId(a,e,b,!0)},destroy:function(){var a=this.cache;a&&a.removeAll(this.id);this.wr()}})})();ovi.provide("nokia.maps.map.provider.SpatialTileProvider");
(function(){var d=nokia.maps,k=d.util.Coroutine,h=d.geo.BoundingBox,c=d.map,b=d.map.provider,g=b.SpatialTile;nokia.maps.map.provider.SpatialTileProvider=new ovi.Class({Extends:nokia.maps.map.provider.TileProvider,initialize:function(a,e){this.xl=a;a.addListener("update",this.ad=ovi.bind(this,this.ad));this.ml=a instanceof b.LocalObjectProvider;this.label=a.label+"[Spatial]";this.min=a.min;this.max=a.max;this._super(e);this.ft=Math.round(c.Polyline.Vh/2)+1;this.Xg={};this.Vl(this);this.We=ovi.Array()},
wv:1,fo:0,shutdown:function(){this.xl.removeListener("update",this.ad);this._super()},ad:function(){this.yg=this.xl.getInvalidationMark(!0)},finishRequest:function(a,b,c,f){this._super(a,b,c,f);f||this.bu(b)},bu:function(a){var b,c,f;f=(b=this.We).length;for(c=0;c<f;c++)if(b[c]===a)return b.splice(c,1)},Vl:k.create("nokia.maps.map.provider.SpatialTileProvider#_paintCo",function(a){for(var a=a.that,b;b=a.We.shift();)if(b.paint(1),a.finishRequest(b.id,b),k.shallYield())return k.yield();return k.wait(a.Xg)},
"that"),ws:function(a){for(var b=a.length,c=0;b--;)c+=a[b].path.internalArray.length;return c},create:function(a,b,c,f){a=new g(f,this,new this.Vq[a](b,c),a);a.Ut();a.state!==!1&&(this.fo||this.ws(a.ah)<3E3?(a.paint(),this.finishRequest(f,a,!1,!0)):(this.We.push(a),k.signal(this.Xg)));return a},zs:function(a,b){for(var c=this.ml,f=this.ft,f=this.xl.requestBBox(b?new h(a.xyToGeo(-f,-f),a.xyToGeo(this.width+f,this.height+f),!0):new h(a.xyToGeo(0,0),a.xyToGeo(this.width,this.height),!0),1,b),d=f.length,
g=-1,k=[],q;++g<d;)(q=c?f[g]:f[g].getObject(!0))&&k.push(q);return k}})})();ovi.provide("nokia.maps.map.provider.ImgTileProvider");
(function(){var d=nokia.maps,k=d.dom,h=d.map.provider.Tile,c=k.imgLoader;nokia.maps.map.provider.ImgTileProvider=new ovi.Class({Extends:nokia.maps.map.provider.TileProvider,initialize:function(b){this._super(b)},create:function(b,d,a,e,l){var f=this,p,m=new h(e,p=document.createElement("img"),f),b=f.getUrl(b,d,a);l?k.loadImg(p,b)!==!0?k.cancelImg(p):m.state=!0:c.request(p,b,function(a,b,c){m.state=b;f.finishRequest(e,m,!1,c)});return m},cancel:function(b){var d;(d=this._super(b))&&c.cancel(d.data);
return d}})})();ovi.provide("nokia.maps.map.overlay.TrafficIncidents");
(function(){var d={x:12,y:12},k=nokia.maps.map.provider.Tile,h=nokia.maps.net.Request,c=nokia.maps.gfx.BitmapImage;nokia.maps.map.overlay.TrafficIncidents=new ovi.Class({Extends:nokia.maps.map.provider.TileProvider,initialize:function(b){this._super(b);this.Ms=new nokia.maps.language.Manager;this.Aj=new h(h.JSONP);this.cache=new nokia.maps.util.Cache(50);this.f=new nokia.maps.map.Container;this.sl={};this.wo=this.rr();this.Qq=ovi.bind(this,function(){this.f.objects.clear();this.sl={};this.ie&&this.ie.close();
this.ie=null});this.xt=ovi.bind(this,function(b){var a;if(b.target instanceof nokia.maps.map.Marker&&(a=b.target,a.$content))b=b.display,this.xu(a,b)});this.f.addListener("click",this.xt)},rr:function(){var b=nokia.maps.loadPath+"assets/ovi/mapsapi/ui/images/trafficitems/";return{CONSTRUCTION:new c(b+"construction.png",null,24,24),EVENT:new c(b+"event.png",null,24,24),"MASS TRANSIT":new c(b+"masstransit.png",null,24,24),INCIDENT:new c(b+"incident.png",null,24,24)}},setup:function(b){this.W=b;b.objects.add(this.f);
b.addObserver("zoomLevel",this.Qq)},teardown:function(b){this.ie&&this.ie.close();b.objects.remove(this.f);b.removeObserver("zoomLevel",this.Qq)},getInvalidations:function(){return 0},request:function(b,c,a,e){var d=this.W.zoomLevel;if(d>this.max||d<this.min)return!1;(d=this.cache.get(this.createId(b,c,a)))?this.jp(d):!e&&this._super(b,c,a,e);return!1},create:function(b,c,a,e){var d=this,f=new k(e,0,d);d.Aj.send(this.getUrl(b,c,a),function(a){if(!a.error&&!a.timeout)f.data=a.response,d.jp(f);d.finishRequest(e,
f,!1,!1)});return f},cancel:function(b){this.Aj.cancel(b)},jp:function(b){var c=b.data,a,e,h,f;this.cache.get(b.id)||this.cache.add(b.id,b,1);if(c.TRAFFICITEMS&&c.TRAFFICITEMS.TRAFFICITEM){c=c.TRAFFICITEMS.TRAFFICITEM;for(b=c.length;b--;){a=c[b];e=a.TRAFFICITEMID;if(this.sl[e])break;a.LOCATION&&a.LOCATION.GEOLOC&&a.LOCATION.GEOLOC.ORIGIN&&(h=new nokia.maps.geo.Coordinate(a.LOCATION.GEOLOC.ORIGIN.LATITUDE,a.LOCATION.GEOLOC.ORIGIN.LONGITUDE),f="",a.TRAFFICITEMDESCRIPTION&&(f+=a.TRAFFICITEMDESCRIPTION[1].content+
"<br/>"),a.CRITICALITY&&a.CRITICALITY.DESCRIPTION&&(f+=this.Ms.translateToken("ovi.service.map._t90")+": "+a.CRITICALITY.DESCRIPTION),a=new nokia.maps.map.Marker(h,{icon:this.wo[a.TRAFFICITEMTYPEDESC]||this.wo.INCIDENT,anchor:d,$content:f}),this.sl[e]=a,this.f.objects.add(a))}}},xu:function(b,c){var a=this.ie,e;if(!(e=c.getComponentById("InfoBubbles")))c.components.add(e=new nokia.maps.map.component.InfoBubbles);a&&this.ie.close();this.ie=e.openBubble(b.$content,b.coordinate)}})})();ovi.provide("nokia.maps.map.render.p2d.dom.ObjectLayer");
(function(d){function k(a){a=a.appendChild(a.ownerDocument.createElement("div"));a.style.position="absolute";a.style.zIndex=0;return a}var h=[],c=d.map,b=c.provider,c=c.render.p2d.dom,g=c.MarkerLayer,a=c.SpatialTileLayer,e=b.SpatialTileProvider;d.map.render.p2d.dom.ObjectLayer=new ovi.Class({initialize:function(a,e,c,d,h,q){this.dt=c;this.fj=ovi.bind(this,this.fj);this.f=a;this.k=e;this.Js=e instanceof b.LocalObjectProvider;this.cb=d;this.Cn(h,q);a=k(a);this.Qi=new g(a,e,c,this.fj)},Cn:function(b,
c){var d=this.oq,g=this.k;if(this.gm!==b||!c.equals(this.Jb))this.gm=b,this.Jb=c,d&&d.shutdown(),this.fe=new a(this.fe?this.fe.shutdown():k(this.f),this.oq=new e(g,{projection:b,width:c.x,height:c.y}),this.dt,this.fj),this.oq.fo=1},wq:0,fj:function(a){(this.wq|=a===this.fe?1:2)===3&&this.cb(this)},shutdown:function(){this.cb=d.util.J;this.fe.shutdown();this.Qi.shutdown();this.f.innerHTML="";return this.f},stop:function(){this.fe.stop();this.Qi.stop()},render:function(a,b,c,e,d,g,h,k,u,w,v,x,z){var A=
this.fe.render(a,b,c,e,d,g,h,k,u,w,v,x,z),a=this.Qi.render(a,b,c,e,d,g,h,k,u,w,v,x,z);this.wq=0;return A&&a},Qb:function(a,b,c,e,d){a=this.Qi.Qb(a,b,d);if(!d||!a.length)a=a.concat(this.fe.Qb(c,e,d));return a},io:function(a){var a=this.k.requestBBox(a,3),b;if(!this.Js)for(b=result.length;b--;)a[b]=a[b].getObject();return a||h},capture:function(){console.warn("ObjectLayer.capture not implemented yet")}})})(nokia.maps);ovi.provide("nokia.maps.map.js.nlpTileProviders");
(function(d){function k(a){a=new d.map.provider.ImgTileProvider(a);a.getUrl=function(a,c,e){this.qs||this.ps();var f=this.subDomains,d=this.mode==="community"?"."+this.mapColors:this.mapType+"."+this.mapColors,f=[this.protocol,f?f[(c+e)%f.length]+".":"",this.baseUrl,this.tileType?this.tileType+"/":"",this.version?this.version+"/":"",d.length>1?d+"/":"",this.mode==="nokia"?l.nokia(a,c,e)+this.width+"/":"",this.imgType,this.mode==="community"?l.navteq(a,c,e):""],d=this.additionalParameters,g=[],h;if(this.mode===
"navteq")d.quadKey=l.navteq(a,c,e);for(h in d)g.push(encodeURI(h+"="+d[h]));f.push(g.length>0?"?"+g.join("&"):"");return b.addNlpParams(f.join(""),!0)};a.ps=function(){var a=this.additionalParameters,b=g.defaultLanguage;if(!a.lg&&g.defaultLanguage&&(b&&(b=b.substr(0,2)),b&&(b=e[b]),b))a.lg=b;this.qs=!0};a.setTileVersion=function(a){if(a!=this.version)this.version=a,this.update()};a.getCopyrights=function(a,b){return c.copyrights.get(this.mapType,a,b)};return a}var h=d.util,c=d.map.js,b=nokia.maps.util.services,
g=h.getRootNameSpace("nokia.maps").Settings,a=c.nlpTileProviders,e={en:"ENG",zh:"CHI",es:"SPA",fr:"FRE",it:"ITA",de:"GER",ru:"RUS"},l={nokia:function(a,b,c){return a+"/"+c+"/"+b+"/"},navteq:function(a,b,c){for(var e,f=[];a-- >0;)e=1<<a,f.push(((c&e)!==0)+((b&e)!==0)*2);return f.join("")}},f={min:0,max:20,width:256,height:256,label:"Map",description:"Show street map",protocol:"http://",subDomains:[1,2,3,4],baseUrl:"maps.nlp.nokia.com/maptile/2.1/",tileType:"maptile",version:"newest",mapType:"normal",
mapColors:"day",additionalParameters:{},mode:"nokia",imgType:"png8",providerType:"base"},f={NORMAL:h.flatMerge({},f),SATELLITE:h.flatMerge({mapType:"hybrid",label:"Hybrid",description:"Show hybrid imagery"},f),SATELLITE_PLAIN:h.flatMerge({mapType:"satellite",label:"Satellite",description:"Show satellite imagery"},f),TERRAIN:h.flatMerge({mapType:"terrain",label:"Terrain",description:"Show terrain map"},f),SMARTMAP:h.flatMerge({mapColors:"day.grey",label:"Smart Map",description:"Show smart map"},f),
SMART_PT:h.flatMerge({mapColors:"day.transit",label:"Public Transit Map",description:"Show public transport"},f),TRAFFIC:h.flatMerge({subDomains:null,baseUrl:"traffic.nlp.nokia.com/traffic/6.0/tiles/",mapColors:"",tileType:null,mapType:"",version:null,label:"Traffic Map",description:"Show traffic",updateCycle:169,providerType:"overlay"},f),NORMAL_COMMUNITY:h.flatMerge({baseUrl:"communitymaptiles.nokia.com/tilehub/",mapType:"normal",mapColors:"",tileType:"live/map",imgType:"png/",mode:"community",
min:1,version:null,label:"Community Map",description:"Show map with live community edits",updateCycle:180},f),SATELLITE_COMMUNITY:h.flatMerge({baseUrl:"communitymaptiles.nokia.com/tilehub/",mapType:"satellite",mapColors:"",tileType:"live/sat",imgType:"png/",mode:"community",min:1,version:null,label:"Community Satellite Map",description:"Show satellite map with live community edits",updateCycle:180},f)},p,m=[],r=[],q={};for(p in f){var y=k(f[p]);(y.providerType==="base"?m:r).push(q[p]=y)}a.constants=
q;a.base=m;a.overlays=r;if(h.isWebGl())a.constants.GLOBE=new nokia.maps.map.provider.GlobeProvider,a.constants.PANORAMA=new nokia.maps.map.provider.PanoramaProvider,a.constants.COVERAGE=new nokia.maps.map.provider.ImgTileProvider({max:20,getUrl:function(a,c,e){return b.addNlpParams(["http://"+((c+e)%4+1)+".maps.nxt.nlp.nokia.com/maptiler/v2/rctile/newest/normal.day",a,e,c,"256/png8?lg=ENG"].join("/"))},getCopyrights:function(a,b){return c.copyrights.get("normal",a,b)}});a.constants.TRAFFIC.minDataZoomLevel=
6;a.constants.TRAFFIC.maxDataZoomLevel=20;a.constants.SMART_PT.minDataZoomLevel=10;a.constants.SMART_PT.maxDataZoomLevel=20})(nokia.maps);ovi.provide("nokia.maps.map._packaging.package");ovi.provide("nokia.maps.map.render.p2d.dom.Engine");
(function(d){function k(a,b){return a instanceof b}function h(a,b,c,e){var f=a.ownerDocument;e?e=f.createComment("comment"):(e=f.createElement("div"),e.style.position="absolute",e.style.zIndex=0);c?a.replaceChild(e,b):a.insertBefore(e,b||null);return e}var c=[],b=Number.POSITIVE_INFINITY,d=nokia.maps,g=d.dom,a=d.util,e=a.Coroutine,l=a.c,f=a.Ne,p=a.Vector3D,m=new a.Matrix3D,r=d.css.applyMatrix,q=d.css.supportsTransition,y=self.clearTimeout,s=Math,u=s.pow,w=s.min,v=s.max,x=s.round,z=s.floor,A=s.LN2,
B=s.log,D=s.abs,E=s.tan,G=s.sqrt,s=s.PI,N=a.Point,Q=[].slice,X=d.geo,J=X.mercator,C=E(35/180*s),H=s*6371E3,ba=new N(256,256),S=[0,0,0,0],da=[-256,-256,-256,-256],ea=X.Coordinate,I=X.BoundingBox,E=d.map,s=E.provider,aa=s.TileProvider,F=s.LocalObjectProvider,K=s.ImageProvider,la=s.CanvasProvider,M=E.render,ia=M.p2d.dom,ta=ia.capabilities,pa=ia.Animation,Z=ta.ZOOM,W=ta.COORD,R=ta.SIZE,U=ia._helpers.geoToScreen,T=ia.TileLayer,Ma=ia.ObjectLayer,wb=ia.ImageLayer,va=ia.CanvasLayer,fa=0;ia.Engine=new ovi.Class({initialize:function(a,
b,e,c){var c=c||{},f=this;f.km={};f.Up=f.cu(f);f.d=fa++;f.ki="nma_p2d_"+f.d;f.su(c.fading);f.Le=m;f.Gt=c.onViewChange||function(){};f.Bt=c.onStateChange||function(){};f.yp=c.onValueExceeded||function(){};f.nj=c.onTransition||function(){};f.ei=ovi.bind(f,f.ei);f.Ag=h(f.f=a);f.A={latitude:0,longitude:0,altitude:0,heading:0,tilt:0,incline:0,zoom:0,distance:0};f.pd={latitude:0,longitude:0,altitude:0,yaw:0,pitch:0,roll:0,fov:70};f.U=new X.PixelProjection(J,2,2,1,1);f.vb=new N(0.5,0.5);f.Lc=new N(a.offsetWidth,
a.offsetHeight);f.Ve=[0,0,0,0];f.Bp=new N(0,0);f.gb=new N(0,0);f.Wd=new N(0,0);f.He=new d.map.render.InteractionRecorder;f.xc=ovi.bind(f,f.xc);f.ad=ovi.bind(f,f.ad);f.$s=0;f.at=0;f.zc=2147483647;f.yh("busy");f.Pi=h(f.Ag,void 0,!1,!0);f.setMapProvider(b);f.hq(e);f.Ps();f.ck();f.$t=setTimeout(function(){c.onReady(f)},1)},Ps:function(){var a=this.f;a.style[d.css.Zu+"Transition"]+=","+d.css.ln+"transform .15s linear";a.addEventListener&&a.addEventListener(d.css.Hq,ovi.bind(this,this.qt),!1)},Aq:null,
Yu:function(a,b){var c=this.Pi.className=this.ki+"MapLayer",e=null;b>0&&(b/=1E3,e=g.xn(a,"."+c+" ."+this.ki+"Tile",d.css.ln+"transition: opacity "+b+"s linear;position: absolute;"));g.Pp(a,this.Aq);this.Aq=e},loadDestinationCam:function(a,b){var c=this.viewToCam(a);this.Fm(a);this.er=!0;this.update(!0,!0);b(c)},setHandoverProperties:function(){},exit:function(a,b){this.onExit=b;a?this.setCam(a):(this.onExit(),this.onExit=void 0)},enter:function(a,b){this.onEnter=b;a?this.setCam(a):(b.call(this),this.onEnter=
void 0)},TRANSITION_START:1,TRANSITION:2,TRANSITION_END:4,capabilities:ta,yf:0,xc:function(){var a=this;this.So&&!--this.So&&setTimeout(function(){a.yh("idle")},0)},sk:function(a,b){return k(a,F)||k(a,aa)||k(a,K)||k(a,la)&&(!b||a.projection===this.U.p)},jo:function(a){return this.Ag.childNodes[a+1]},cr:function(a,b){for(var c=this.Ul,e,f=this.Ue,d,g=f.length;g--;)d=f[g],e=c.get(g),this.sk(e,!0)?d?k(e,F)&&d.Cn(a,b):h(this.f,d.shutdown(),!0,!1):d&&h(this.f,d.shutdown(),!0,!0)},setMapProvider:function(b){var c=
this,e=c.rc,f=c.Dg,d,l,m=c.Jb,p,q=c.U,r={cssClass:c.ki};if(b!==e&&(p=c.sk(b),c.Pi=d=h(c.Ag,c.Pi,!0,!p),g.mo(c.Pi.ownerDocument,function(a){c.Yu(a,c.Ok)}),f&&(f.shutdown(),c.Hj(e,!1),--c.yf),p?(c.Hj(b,!0),++c.yf,k(b,aa)?(r.fading=c.Ok,f=new ia.MapLayer(d,b,r,c.xc),l=b.projection,e=b.tileSize):f=new ia.ObjectLayer(d,b,r,c.xc,l=J,e=ba)):e=f=void 0,m=this.Ul&&(l!==q.p||!e.equals(m)),c.rc=b,c.Dg=f,q.p=l,c.Jb=e,p))c.Wm=e.x/e.y,c.Fj(c.vb),c.Fb(a.da(c.A.zoom,b.min,b.max)),m&&c.cr(l,e)},Hj:function(a,b){a[(b?
"add":"remove")+"Listener"]("update",this.ad)},hq:function(a){var b,c,e;a?(b="add",this.Ul=a,this.Ue=ovi.Array([])):(b="remove",a=this.Ul);c=a.getLength();for(e=0;e<c;)this.zp(a,b,a.get(e),e),e++;a[b+"Observer"](this.zp,this);this.update(!1,!0)},zp:function(a,b,c,e){var a=this.Ue,f,d=this.sk(c),g,k={cssClass:this.ki};if(b==="add")f=h(this.Ag,this.jo(e),!1,!d),d&&(++this.yf,this.Hj(c,!0),g=this.Tr(c,f,k),r(g.f,this.Le.translate(this.gb.x,this.gb.y,0))),a.splice(e,0,g);else{if(g=a[e])this.Hj(c,!1),
f=g.shutdown(),--this.yf;f=a[e]?f:this.jo(e);a.splice(e,1);f&&this.Ag.removeChild(f)}this.update(!1,!0)},Tr:function(a,b,c){var e=this.xc;return k(a,F)?new Ma(b,a,c,e,this.U.p,this.Jb):k(a,aa)?new T(b,a,c,e):k(a,K)?new wb(b,a,c,e):k(a,la)?new va(b,a,c,e):void 0},Jb:ba,Wm:1,ad:function(){this.update(!1,!0)},In:function(a){var b=this.zc;if(b&&(this.Gt(this,b,a),a))this.zc=0},ei:function(){var a=this.state;this.pk=0;if(a!==this.Xt)this.Bt(this,this.Xt=a)},yh:function(a){if(a!==this.state&&(this.state=
a,!this.pk))this.pk=setTimeout(this.ei,0)},shutdown:function(){this.sa&&this.sa.stop(!0);this.hq();this.setMapProvider();y(this.$t);a.cancelAnimationFrame(this.zj);y(this.lm);y(this.pk);e.kill(this.Up);this.state="shutdown";this.ei()},update:function(b,c){var f=this,d=f.Up,g=d.scope;if(f.er&&!f.Ao){f.Ao=!0;f.In(!0);if(b)g.cacheOnly=c,d.run(!0,!0);else{if(c){var h=function(){g.cacheOnly=!0;e.signal(f.km);f.zj=a.requestAnimationFrame(h)};!f.zj&&h()}a.cancelAnimationFrame(f.zj);f.zj=0;if(!f.lm)f.lm=
setTimeout(function(){g.cacheOnly=!1;e.signal(f.km);f.lm=0},300)}f.Ao=!1}},cu:e.create("nokia.maps.map.render.p2d.Engine#_renderCo",function(a){var b=a.that,c=a.cacheOnly,f,d=a.i,g=b.Ue,h=g.length;f=a.Lo;var k=b.gb;f&&f.x!==b.vb.x&&f.y!==b.vb.y&&(d=void 0);b.yh("busy");if(d===void 0&&(b.So=b.yf,f=b.Dg))r(f.f,b.Le=m.translate(k.x,k.y,0)),f.render(b.A.zoom,b.vb,b.U,b.Ve,b.Lc,k,b.Vk(da),0,0,0,b.A.zoom-x(B(f.k.width/256)/A),c,b.Wd);d=d||0;if(!c&&e.shallYield())return b.cq(a,d),e.yield();for(;d<h;){if(f=
g[d++])r(f.f,b.Le),f.render(b.A.zoom,b.vb,b.U,b.Ve,b.Lc,k,b.Vk(da),0,0,0,void 0,c,b.Wd);if(!c&&d!==h&&e.shallYield())return b.cq(a,d),e.yield()}if(!c)b.Wd.x=k.x,b.Wd.y=k.y;a.i=void 0;a.Lo=void 0;b.$s=0;b.at=0;return e.wait(b.km)},"that"),md:function(a,b){var c=this.U,e=this.vb,f=c.w,d=c.x+=a;this.Le.clone();e.x=(c.x=(d%f+f)%f)/f;e.y=(c.y+=b)/c.h;this.xh(c.p.pointToGeo(e),!0)},cq:function(a,b){a.i=b;a.Lo={x:this.vb.x,y:this.vb.y}},kv:function(){var a=this.Dg.k,b=this.U,c=this.A.zoom;return scale=new nokia.maps.util.Point(b.w/
(Math.pow(2,c)*a.Jb.x),b.h/(Math.pow(2,c)*a.Jb.y))},ck:function(){var a=this.Lc,b=this.gb,c=this.Wd,e=this.Ve,f=e[0],d=e[3],g=a.x-d-e[1],a=a.y-f-e[2],e=this.Bp;r(this.Dg.f,this.Le=this.Le.translate(b.x=c.x=x(g/2+d),b.y=c.y=x(a/2+f),0));e.x=v(g,0);e.y=v(a,0);this.nm();this.update(!0)},resize:function(a,b){this.Lc.x=a;this.Lc.y=b;this.zc|=R;this.ck()},setPadding:function(a,b,c,e){this.Ve.splice(0,4,+a||0,+b||0,+c||0,+e||0);this.ck()},suspend:function(){this.yh("suspended")},resume:function(){this.yh("idle")},
type:"2d",Ok:0,su:function(a){this.Ok=g.Page.browser.mobile?0:+a},kf:0,setTransition:function(a,b){this.kf=a;this.$m=b},getView:function(){return this.A},Fj:function(a,b){var c=this.vb,e=this.U;e.x=e.w*(c.x=a.x);e.y=e.h*(c.y=a.y);b||this.xh(e.p.pointToGeo(c),!0)},xh:function(a,b){var c=this.A,e=this.pd;b||this.Fj(this.U.p.geoToPoint(a),!0);if(c.latitude!==a.latitude||c.longitude!==a.longitude)c.latitude=e.latitude=a.latitude,c.longitude=e.longitude=a.longitude,this.zc|=W;this.nm();this.update(!1,
!0)},nm:function(){this.T=this.Ap=this.Wo=0},Bh:function(a,b,c,e,f){var d=this;d.sa&&d.sa.isRunning&&(d.sa.stop(f),d.nj(d.TRANSITION_END));d.nj(d.TRANSITION_START);d.sa=new pa(function(){a.apply(a,arguments);d.nj(d.TRANSITION)},function(){b&&b.apply(b,arguments);d.nj(d.TRANSITION_END)},c,e);d.sa.start()},ro:function(){var a;if(this.onExit)a=this.onExit,this.onExit=void 0,a();if(this.onEnter)a=this.onEnter,this.onEnter=void 0,a();this.In()},setView:function(a){var b=this,c=b.A.zoom,e=(a.zoom!==void 0?
a.zoom:b.Jk(a.distance))-c,f,d=!0,g,h;b.kf===ia.Engine.TRANSITION.AUTO&&b.Jn(a)?b.Bh(function(k){d&&(f=c+k*e,b.gi(f)?d=!1:b.Fb(c+k*e));g=b.U.p.geoToPoint(a);h=b.vb;b.Fj(new N(h.x+(g.x-h.x)*k,h.y+(g.y-h.y)*k));b.update(!0,!0)},function(){b.Fm(a);b.ro()},null,b.$m):(b.Fm(a),b.ro());return b.A},Fm:function(a){this.kf=ia.Engine.TRANSITION.NONE;this.setCoord(a);isNaN(a.distance)?this.Fb(a.zoom):this.setDistance(a.distance);this.kf=ia.Engine.TRANSITION.AUTO},setCoord:function(b){var c=this,e=c.U.geoToPixel(b),
f=c.U.geoToPixel(c.A),d=e.x-f.x,g=e.y-f.y,h,k,l=0;b&&ea.isValid(b.latitude,b.longitude,b.altitude)&&!(c.A.latitude===b.latitude&&c.A.longitude===b.longitude)?c.kf===ia.Engine.TRANSITION.AUTO&&c.Jn(b)?c.Bh(function(a){h=f.x+(a-l)*d;k=f.y+(a-l)*g;c.md(h,k);c.update(!0,!0);l=a},function(){c.xh(b)},a.animation.easeFunctions.EASE_OUT_QUAD,c.$m):c.xh(b):b=c.A;return new ea(b.latitude,b.longitude,b.altitude)},Jn:function(a){var b=this.U.geoToPixel(this.A),a=this.U.geoToPixel(a);return D(a.x-b.x)<=this.Lc.x&&
D(a.y-b.y)<=this.Lc.y},dk:function(a,b,c){c=c.width;return B((b.w=b.h=u(2,x(B(b.w/c)/A))*x(c*u(2,a-x(a))/2)*2)/256)/A},Fb:function(b,c,e){var f=this.A,d=this.U,g=c!==void 0,h=this.gb,b=a.da(b,this.rc.min,this.rc.max);if(g)this.Wd.x=c,this.Wd.y=e,this.md(c-=h.x,e-=h.y,!0);d.w=u(2,b+8);b=this.dk(b,d,this.rc);d.h=d.w*this.Wm;if(b!==this.A.zoom)f.zoom=b,f.distance=this.Uh(b),this.zc|=Z;this.pd.altitude=f.distance+(f.altitude||0);this.Fj(this.vb,!0);g?(b=this.Kg(-e),this.md(-c,b,!1)):(this.nm(),this.update(!1,
!0))},setZoom:function(b,c,e){var f=this,d=f.A,g=f.A.zoom,h=b-g,k=f.rc;if((b=a.da(b,k.min,k.max))!==d.zoom&&!isNaN(b))f.kf===ia.Engine.TRANSITION.AUTO?f.Bh(function(a){f.Fb(g+a*h,c,e);f.update(!0,!0)},function(){f.Fb(b,c,e)},null,f.$m,!0):f.Fb(b,c,e);return d.zoom},getZoom:function(){return this.A.zoom},Uh:function(b){var c=this.rc;return a.da(H/u(2,b)/C,H/u(2,c.max)/C,H/u(2,c.min)/C)},Jk:function(b){return a.da(-(B(b*C/H)/A),this.rc.min,this.rc.max)},setDistance:function(a,b,c){var e=this.A;w(v(a,
0),1/0)===a&&this.Fb(x(this.Jk(a)),b,c);return e.distance},setHeading:function(){return this.A.heading},setTilt:function(){return this.A.tilt},setIncline:function(){return this.A.incline},Vk:function(a){return a===this.Ve?this.Ap||(this.Ap=this.Sf(a)):a===da?this.Wo||(this.Wo=this.Sf(a)):a===S||!a?this.T||(this.T=this.Sf(S)):this.Sf(a)},Sf:function(a){var b=this.Lc,c=this.gb,e=a[0]-c.y,f=a[3]-c.x,d=b.y-c.y-a[2],a=b.x-c.x-a[1],b=this.U;f>a&&(f=a=0);e>d&&(e=d=0);e=b.pixelToGeo({x:f,y:e});d=b.pixelToGeo({x:a,
y:d});if(a-f>=b.w)e.longitude=-(d.longitude=180);return new I(e,d)},Kg:function(a){var b=this.U,c;c=(b.y+a)/b.h;c<0?a=-b.y:c>1&&(a=b.h-b.y);return a},Ir:function(a,b,c,e){var c=a-c,f=b-e,e=G(u(c,2)+u(f,2));a-=c/2;b-=f/2;e=B(u(2,this.Rs)*(e/this.Qs))/A;!this.gi(e,a,b)&&D(this.A.zoom-e)>=0.1&&(this.Fb(e,a,b),this.update(!0,!0))},Fr:function(a,b,c,e){this.md(this.Ci+(this.Co-this.Ci)/2-(a+(c-a)/2),this.Kg(this.Di+(this.Do-this.Di)/2-(b+(e-b)/2)))},getBBox:function(){return this.Vk(this.Ve)},getCenter:function(){return new ea(this.A.latitude,
this.A.longitude,void 0,!0)},camToView:function(a){var b=ea.fromObject([a.latitude,a.longitude,0,a.altMode]),a=b.distance(new ea(a.latitude,a.longitude,a.altitude,!1,a.altMode),!0),c=this.Jk(a),a=this.Uh(c);return ovi.extend({},this.A,b,{distance:a,zoom:c})},getCam:function(){return this.pd},setCam:function(a){this.setView(this.camToView(a));return this.getCam()},setCamCoord:function(a){this.xh(a);return new ea(a.latitude,a.longitude,a.altitude,!0)},setYaw:function(){return this.pd.yaw},setPitch:function(){return this.pd.pitch},
setRoll:function(){return this.pd.roll},viewToCam:function(a){var b=a.distance,b=+b===b?b:this.Uh(a.zoom),a=ea.fromObject([a.latitude,a.longitude,b,a.altMode]);return ovi.extend({},this.pd,a)},Es:function(a,b,c){var e=this.U,f=ovi.extend({},this.A),d=e.w;if(a||b)b=this.Kg(-b*91.401472),a={x:(a*91.401472+e.x)%d/d,y:(e.y+b)/e.h},e=e.p.pointToGeo(a),f.latitude=e.latitude,f.longitude=e.longitude;if(c)f.zoom+=c,f.distance=this.Uh(f.zoom);f.distance=this.Uh(f.zoom);return f},hr:function(a,b,c,e){var f=
this.A,e=e||1;if(a||b)b=this.Kg(-b*91.401472*e),this.md(a*91.401472*e,b);c&&(a=f.zoom+c*e,this.gi(a)||this.Fb(a));this.update(!0,!0)},gi:function(a){var b=this.rc;return a>b.max?(this.A.zoom!==b.max&&this.Fb(b.max),this.yp(Z,a),!0):a<b.min?(this.A.zoom!==b.min&&this.Fb(b.min),this.yp(Z,a),!0):!1},hi:!1,beginControl:function(a,b,c,e){this.hi=Q.call(arguments,0);this.Mi=b;this.Lr=ovi.extend({},this.getView());this.mv=c;this.nv=e;this.sa&&this.sa.isRunning&&this.sa.stop(!0)},control:function(a,c,e,f,
d,g,h,k){var l=this,m=l.A,p,f=f||k;if(l.hi)l.Bh(function(a,b,d){p=m.zoom+f*d;l.gi(p)?f=0:l.hr(c,e,f,d);if(this!==l.sa)return!0},null,null,b),l.Nr=c,l.Or=e,l.Pr=f,l.ov=k},endControl:function(a){var b=this.Mi,c,e,f,g=this.A;e=!1;if(this.hi)this.hi=!1,this.sa&&this.sa.isRunning&&this.sa.stop(),b&&(c=new p(this.Nr,this.Or,this.Pr),e=c.normalize(),f=c.magnitude(),c=typeof b.duration==="function"?b.duration(f):600,b=typeof b.power==="function"?b.power(f):1,f*=b,b=new d.map.render.KineticMove(f,-(f/c)),
b=b.getPath(c),e=this.Es(e.x*b,e.y*b,e.z*b)),a=typeof a==="function"?a(this.Lr,g):e,a!==!1&&(this.setTransition(ia.Engine.TRANSITION.AUTO,c),this.setView(a))},dr:function(a){if(a&=ta.ui)for(var b=a&W,c=W,e=0;c>>=1;){if(a&c&&(b|=c,++e>1))break}else b=W;return b},beginInteraction:function(a,b,c,e,f,d,g){if(this.il)this.Kk=null,this.sa&&this.sa.isRunning&&this.sa.stop(),this.endInteraction();if(this.Bi=this.dr(a)){this.il=!0;this.Ci=e;this.Di=f;if(d===+d&&g===+g)this.Co=d,this.Do=g;this.Qs=G(u(e-d,2)+
u(f-g,2));this.Rs=this.A.zoom}if(this.Mi=b)this.He.reset(),this.He.recordXY(c,e,f)},interact:function(a,c,e,f,d){var g,h;if(this.il)if(this.Po&&a-this.Po<=25)this.Ni=[b,c,e,f,d],this.He.recordXY(a,c,e,f,d);else{if(a!==b)this.Po=a;f===+f&&d===+d?(this.Bi&W&&this.Fr(c,e,f,d),this.Bi&Z&&this.Ir(c,e,f,d),this.Co=f,this.Do=d):this.Bi&W&&(g=this.Kg(this.Di-e),h=this.Ci-c,this.md(h,g));this.Ci=c;this.Di=e;this.Mi&&this.He.recordXY(a,c,e,f,d);this.Ni=void 0}},endInteraction:function(a){var b=this,c=b.Mi,
e=b.U,f,g,h,k,l,m,p;c&&(f=b.He.getInteractionDirection(a),k=b.He.getInteractionSpeed(a),g=typeof c.duration==="function"?c.duration(k):600,a=typeof c.power==="function"?c.power():1,l=k*a,p=new d.map.render.KineticMove(l,-(l/g)),!isNaN(f.x)&&!isNaN(f.y)&&l>0&&b.Bh(function(a){l=p.getValue(a*g);if(b.Bi&W&&!isNaN(l)){m=-f.y*l;h=(e.y+m)/e.h;if(h<0||h>1)f.y=-f.y,m=-f.y*l;b.md(-f.x*l,-f.y*l,!0);b.update(!0,!0)}},null,c.ease,g));b.Ni&&b.interact.apply(b,b.Ni);b.il=!1;b.Ni=void 0},setPointer:a.J,screenToGeo:function(a,
b){return this.U.pixelToGeo(new N(a-this.gb.x,b-this.gb.y))},geoToScreen:function(a){return U(a,this.U).add(this.gb).round()},convertAlt:function(a,b){var c=a.altMode||"GL";return c===(b||"GL")?a.altitude:NaN},viewForXY:function(a,b){return ovi.extend({},this.A,this.U.pixelToGeo(new N(a-this.gb.x,b-this.gb.y)))},viewForBBox:function(a){var b=30,c=ovi.extend({},this.A,a.getCenter()),e,f,d=this.Bp,g;a.isEmpty()||(f=new X.PixelProjection(this.U.p,e=u(2,b),e*this.Wm),g=f.geoToPixel(a.topLeft),f=f.geoToPixel(a.bottomRight),
b-=8+v(B(a.isCDB?e-g.x+f.x:f.x-g.x)/A-B(d.x)/A,B(f.y-g.y)/A-B(d.y)/A));c.zoom=z(b);c.distance=NaN;return c},viewFor:function(a){for(var b=[],c=a.length;c--;)b.push(a[c].getBoundingBox());return this.viewForBBox(I.merge(b))},getObjectAt:function(a,b){return this.Qb(a,b,!0)[0]},getObjectsAt:function(a,b){return this.Qb(a,b,!1)},Qb:function(a,b,e){var d=this.Ue,g=d.length,h,k,l,m=!1,p=this.U,q=this.gb;a-=q.x;b-=q.y;for(e=!!e;g--;)if((h=d[g])&&h instanceof Ma)if(k=h.Qb(a,b,f((p.x+a)/p.w,1),f((p.y+b)/
p.h,1),e),k.length){if(e)break;l=m?l.concat(k):k;m=!0}return l||k||c},getObjectsWithin:function(a,b,c,e){for(var f=this.Lc,a=this.Sf([b,f.x-c,f.y-e,a]),b=this.Ue,c=b.length,e=[];c--;)f=b[c],f.io&&(f=f.io(a))&&f.length&&(e=e.concat(f));return e},capture:function(a,b,c,e,f){var a=new d.gfx.Graphics,g,h=this.Ue,k=h.length;this.Dg.capture(a,b,c,e,f);for(g=0;g<k;g++)h[g].capture(a,b,c,e,f)},cancelCapture:function(){},preload:function(a,b){a||l("view");return new M.Preloader([],b)},bounce:function(a,b,
c){q()&&(b&&c&&(this.f.style[d.css.getVendorJsProperty("transformOrigin")]=[b,"px ",c,"px"].join("")),this.f.style[d.css.getVendorJsProperty("transform")]="matrix("+(!a?".9, 0, 0, .9, 0, 0":"1.1, 0, 0, 1.1, 0, 0")+")")},qt:function(a){if(/\btransform$/.test(a.propertyName))a=a.target.style,a[d.css.getVendorJsProperty("transform")]!=="matrix(1, 0, 0, 1, 0, 0)"?a[d.css.getVendorJsProperty("transform")]="matrix(1, 0, 0, 1, 0, 0)":this.gv=!0}});ia.Engine.TRANSITION={AUTO:0,NONE:1}})(nokia.maps);ovi.provide("nokia.maps.map.Display");
(function(d){var k=d.css,h=d.util,c=h.Point,b=Math.max,g=h.da,a=h.c,e=d.map,l=e.render.Capabilities.prototype,f=d.geo.Coordinate,p=d.dom,m={add:"attach",remove:"detach"},r=ovi.buildNS(d.config.tileProviders),q=e.Display=new ovi.Class({Extends:e.Container,initialize:function(a,b){var g=this,k,l,b=b||{};l=f.fromObject(b.center||b.view||[0,0]);k=b.view?b.view:l?ovi.extend({zoom:b.zoomLevel||0,altitude:0},l):{latitude:0,longitude:0,altitude:0,zoom:0};b.center=l;g.nl=0;g.Ke=0;g.Ie=!0;g.L=new e.Sq;d.util.getRootNameSpace("nokia.maps").Settings.lockLanguage();
d.map.js.copyrights.loadCopyright();g.availableBaseMapTypes=new h.OList(r.base);l=b&&b.baseMapType||g.availableBaseMapTypes.get(0);g.availableOverlays=new h.OList(r.overlays);g.overlays=new h.OList;g.Lk=new h.OList;g.overlays.addObserver(g.Jt,g);g.Jr(a);g.o=new c(g.O.offsetWidth,g.O.offsetHeight);g.ni=g.o.divide(2).round();g.Hl=ovi.bind(g,g.Hl);g.El=ovi.bind(g,g.El);g.Gl=ovi.bind(g,g.Gl);g.Fl=ovi.bind(g,g.Fl);g.Dl=ovi.bind(g,g.Dl);g.addObserver("baseMapType",ovi.bind(g,g.ot));g.Vc=k;g.copyrightPosition=
g.poweredByPosition=new c(0,0);g.fading="fading"in b?b.fading:150;g.components=new h.OList;g.components.addObserver(g.Er,g);g.set("baseMapType",l);g.components.Xq=g.components.I;g.components.I=function(a,b,c){for(var e=this.X,f=e.length,d=a.getId();f--;)e[f].getId()===d&&h.c('Component instance with ID "'+d+'" already registered');this.Xq(a,b,c)};l=b.components;delete b.components;b.viewBounds&&(delete b.center,delete b.zoomLevel,delete b.view,delete b.cam);g._super(b);g.Lk.add(new e.provider.LocalObjectProvider(this,
{min:-8,max:22}));k=g.parentDisplay;g.Qr=(g.xv=k&&k.visibility&&k.width>g.width&&k.height>g.height)?null:d.map.vn&&new d.map.vn(g);g.zc=0;g.pl=0;if(l)g.components.addAll(l),b.components=l;g.addListener("mouseleave",g.Dm);g.addListener("mousemove",g.Dm);g.addListener("drag",g.Dm);g.Ff=ovi.bind(g,g.Ff);g.addListener("mapvalueexceeded",g.Ff,!1);g.addObserver("bounceEnabled",function(a,b,c){c?g.addListener("mapvalueexceeded",g.Ff,!1):g.removeListener("mapvalueexceeded",g.Ff,!1)});g.Bn()},destroy:function(){for(var a,
b=this.components;b.getLength()>0&&(a=b.get(0));)this.removeComponent(a);this.gh&&this.gh.destroy();this.Mh&&this.Mh.destroy();this.O&&this.O.parentNode&&this.O.parentNode.removeChild(this.O);this.gh=this.Mh=null;try{this.m&&this.m.shutdown()}catch(c){c.toString()!=="Error: Permission denied"&&c.toString()!=="[object Error]"&&h.c(c)}this.m=null;clearTimeout(this.Qj);clearTimeout(this.pl)},Jt:function(b,c,e,f){var d=this.Lk,g=ovi.type(e);if(g==="null"||g==="undefined")b.removeAt(f),a(e);c==="add"?
(e.setup&&e.setup(this),d.add(e,f)):(d.removeAt(f),e.teardown&&e.teardown(this))},animation:new h.OList(["none","default"]),s:"display",copyrightAlignment:"bottomleft",copyrightWidth:0,copyrightHeight:0,minZoomLevel:0,maxZoomLevel:0,zoomLevel:0,minTilt:0,maxTilt:0,tilt:0,minHeading:0,maxHeading:0,heading:0,padding:{top:0,right:0,bottom:0,left:0},poweredByWidth:0,poweredByHeight:0,fixedCenter:!0,focus:function(){this.O.focus()},blur:function(){this.O.blur()},setZoomLevel:function(a,b,c,e){this.Ub(b);
if(this.L.inProgress)return a;this.Mq(a,c,e);this.m.setZoom(h.da(a,this.minZoomLevel,this.maxZoomLevel),c,e)},setCenter:function(a,b){this.L.inProgress||(this.Ub(b),this.m.setCoord(f.fromObject(a)))},setHeading:function(a,b){this.L.inProgress||(this.Ub(b),this.m.setHeading(h.da(a,this.minHeading,this.maxHeading)))},setTilt:function(a,b){this.L.inProgress||(this.Ub(b),this.m.setTilt(h.da(a,this.minTilt,this.maxTilt)))},setView:function(a,b){if(!this.L.inProgress)return this.Ub(b),this.m.setView(a)},
setCam:function(a,b){if(!this.L.inProgress&&!this.$u(a.fov))return this.Ub(b),this.m.setCam(a)},setPadding:function(a,b,c,e){var f=arguments.length,f=f>3?[a,b,c,e]:f>2?[a,b,c,b]:f>1?[a,b,a,b]:[a,a,a,a];this.set("padding",{top:f[0],right:f[1],bottom:f[2],left:f[3]})},setAttributes:function(a,b,c,e,f){this.L.inProgress||(b!==void 0&&this.set("center",b),c!==void 0&&this.set("zoomLevel",c),e!==void 0&&this.set("tilt",e),f!==void 0&&this.set("heading",f))},setCopyrightAlignment:function(a){this.set("copyrightAlignment",
a)},setBaseMapType:function(a,b,c){if(!this.L.inProgress){this.gr=b==="default"?!0:!1;if(c)this.Vc=c;this.set("baseMapType",a)}},setTransition:function(a){this.L.inProgress||this.m.setTransition(a)},getZoom:function(a,b){return this.m.getZoom&&this.m.getZoom(a,b)||this.getView().zoom},getView:function(){if(this.L.inProgress&&!this.Ie)return this.bt;return ovi.extend({},this.m.getView())},getCam:function(){if(this.L.inProgress&&!this.Ie)return this.Zs;return ovi.extend({},this.m.getCam())},getComponentById:function(a){for(var b=
-1,c=this.components.getLength(),e;++b<c;)if((e=this.components.get(b))&&e.getId()===a)return e;return null},addComponent:function(a){var b=this.getComponentById(a.getId());if(b)return b.queryReference();this.components.add(a);return a},removeComponent:function(a){var b=a.releaseReference();b<=0&&this.components.remove(a);return b},Er:function(a,b,c){(a=m[b])&&c[a](this);a==="attach"&&this.An(c)},An:function(a){a.isCompatible(this.m.type)?a.set("enabled",!0,!0):a.set("enabled",!1,!0)},Bn:function(){for(var a=
this.components.asArray(),b=a.length,c;b--;)c=a[b],this.An(c)},getUIContainer:function(){return this.P},getClippingUIContainer:function(){return this.Sa},getHtmlMapContainer:function(){return this.kc},Jr:function(a){var b=new e.DisplayContainer(this,a);this.O=b.O;this.kc=b.f;this.$e=b.$e;this.ji=b.ji;this.P=b.P;this.Sa=b.Sa;this.Mh=b.Mh;this.gh=b.gh;this.addEvent=function(a){b.addEvent(a)};this.removeEvent=function(a){b.removeEvent(a)};this.lv=function(){b.containerDestroy()}},et:function(a){var b=
k.ln;a.style.cssText=b?"position:absolute;z-index:0;width:100%;height:100%;overflow:hidden;transition: opacity .5s linear;".replace(/\b(transition|transform)\b/g,b+"$1"):"";a.addEventListener?a.addEventListener(k.Hq,ovi.bind(this,this.ut),!1):this.Nd&&this.O.removeChild(this.Nd)},ed:function(a,b){this.Ss=!0;this.Vr=a;this.cf(a,b);this.Vr=null;this.Ss=!1},bf:function(a,b){this.m.resize(a,b);this.set("width",a);this.set("height",b);this.o=new c(a,b);this.ni=this.o.divide(2).round()},Gl:function(a,b,
c,e){var f=this.m.capabilities.cam.fov,d=this.baseMapType;a&this.m.capabilities.ZOOM&&this.pi("zoom",b,d.min,d.max);a&l.FOV&&this.pi("fov",b,f.min,f.max,c,e)},Fl:function(a){this.m&&(a&this.m.TRANSITION_START&&this.Zn("start"),a&this.m.TRANSITION&&this.Oj(this.m),a&this.m.TRANSITION_END&&this.Zn("end"))},pi:function(a,b,c,e,f,d){var g=h.now();if(g-this.pl>1E3)this.dispatch(new u({type:"mapvalueexceeded",target:this.kc,display:this,valueData:{propertyName:a,value:b,min:c,max:e,x:f,y:d}})),this.pl=
g},ut:function(a){if(a.target==this.Nd&&a.propertyName==="opacity")this.xb&&this.xb.shutdown(),this.O.removeChild(this.Nd),this.xb=this.Nd=this.Vc=void 0},bounceEnabled:!0,bounce:function(a,b,c){this.L.inProgress||(this.m.setTransition(this.ma.TRANSITION.AUTO),this.m.bounce(a,b,c))},Ff:function(a){var a=a.valueData,b=a.min,c=a.value;a.propertyName in{zoom:!0,fov:!0}&&this.bounce(c<b?!1:!0,a.x,a.y)},xs:function(a){var b=d.map.render;return a&4?[b.globe.Engine,b.globe.capabilities]:a&2?[b.panorama.Engine,
b.panorama.capabilities]:[b.p2d.dom.Engine,b.p2d.dom.capabilities]},hv:function(a){return"pitch"in a&&"roll"in a&&"yaw"in a},qu:function(a){var b=this.Vc,c,e,f,d=this.padding;if(this.L.inProgress)return this.ma;else{this.ma=a;this.L.start();c=document.createElement("div");this.et(c);this.bt=(f=this.xb=this.m)&&f.getView();this.Zs=f&&f.getCam();e=this.Nd=this.Cg;if(f)c.style.visibility="hidden";this.O.insertBefore(c,e||this.ji);if(!b)this.Go=!0,b=f.getView();this.Gk=b;b=this.m=new a(c,this.baseMapType,
this.Lk,{onViewChange:this.Hl,onStateChange:this.El,onValueExceeded:this.Gl,onTransition:this.Fl,onReady:this.Dl,fading:this.fading});b.setPadding(d.top,d.right,d.bottom,d.left);this.Bn();this.Cg=c;return a}},baseMapTypeSetter:function(b){b instanceof e.provider.Provider||a("baseMapType "+b);this.nt=this.baseMapType;return b},componentsSetter:function(a){var b=this.components;b.getLength()&&b.clear();return b.addAll(a)},paddingSetter:function(a){isNaN(a.top-a.right-a.bottom-a.left)&&h.c();var b=this.padding,
c=this.m,e=b.top!=a.top||b.right!=a.right||b.bottom!=a.bottom||b.left!=a.left,b=e?{top:+a.top,right:+a.right,bottom:+a.bottom,left:+a.left}:b;if(e){if(!this.fixedCenter&&this.m.type!=="panorama"&&this.m.type!=="3d"&&(this.ni=this.o.add({x:a.left-a.right,y:a.top-a.bottom}).divide(2).round(),a=c.screenToGeo(this.ni.x,this.ni.y)))c.setTransition(this.ma.TRANSITION.NONE),c.setCoord(a);this.m.setPadding(b.top,b.right,b.bottom,b.left)}return b},Dm:function(a){var b=a.type==="mouseleave";this.m.setPointer(b?
NaN:a.displayX,b?NaN:a.displayY)},centerSetter:function(a){var b=this.m,c=b.type==="panorama";if(this.L.inProgress)return a;this.Ub("NONE");this.Dd||(a=c?b.setCamCoord(f.fromObject(a)):b.setCoord(f.fromObject(a)),a=f.fromObject(a));this.Dd=0;return a},zoomLevelSetter:function(a){var b=h.da(a,this.minZoomLevel,this.maxZoomLevel);if(this.L.inProgress)return b;this.Mq(a);this.Ub("NONE");return this.m.setZoom(b)},tiltSetter:function(a){a=h.da(a,this.minTilt,this.maxTilt);if(this.L.inProgress)return a;
if(!this.Dd)this.Dd=1,a=this.m.setTilt(a);this.Dd=0;return a},headingSetter:function(a){a=h.da(a,this.minHeading,this.maxHeading);if(this.L.inProgress)return a;if(!this.Dd)this.Dd=1,a=this.m.setHeading(a);this.Dd=0;return a},Mq:function(b,c,e){isNaN(b)&&a("zoomLevel");if(!this.L.inProgress&&(b>this.maxZoomLevel||b<this.minZoomLevel))return this.pi("zoom",b,this.minZoomLevel,this.maxZoomLevel,c,e),!0;return!1},$u:function(a){var b=this.m.capabilities.cam.fov;if(!this.L.inProgress&&(a>b.max||a<b.min))return this.pi("fov",
a,b.min,b.max),!0;return!1},fadingSetter:function(){return this.fading},pixelToGeo:function(a,b){return f.fromObject(this.m.screenToGeo(a,b))},geoToPixel:function(a){return this.m.geoToScreen(a)},zoomTo:function(a,b,c){a=this.m.viewForBBox(b?a.resizeToCenter(this.center):a);this.Ub(c);if(a.zoom>this.maxZoomLevel)a.zoom=this.maxZoomLevel,a.distance=NaN;if(a.zoom<this.minZoomLevel)a.zoom=this.minZoomLevel,a.distance=NaN;this.m.setView(a)},getBestZoomLevel:function(a){var c=this.m,e=this.maxZoomLevel,
f,d=a.length;for(isNaN(d)&&h.c();d--;)if((f=c.viewForBBox(a[d]).zoom)<e)e=f;return b(e,this.minZoomLevel)},getViewBounds:function(){return this.m&&this.m.getBBox()||this.xb&&this.xb.getBBox()},getObjectsWithin:function(a,b,c,e){return this.m.getObjectsWithin(a,b,c,e)},getObjectsAt:function(a,b){return this.m.getObjectsAt(a,b)},getObjectAt:function(a,b){return this.m.getObjectAt(a,b)},yu:function(){if(!this.Fg)this.Ae("start",0),this.Fg=!0},Ub:function(a){a=a==="default"?"auto":a;this.ma.TRANSITION&&
this.m.setTransition(this.ma.TRANSITION[a?a.toUpperCase():"NONE"])},Ae:function(a,b){this.dispatch(new q.MapViewChangeEvent({type:"mapviewchange"+a,target:this.kc,display:this,data:b}));if(a!=="start")this.Ke=0},Oj:function(a){var b,c,e,d;if(a instanceof this.ma){b=this.zc;c=a.capabilities;e=a.getView();if(b&c.COORD)a.type==="panorama"&&(d=a.getCam()),a=this.center,this.center=f.fromObject(d||e),this.Fc("center",this.center,a);if(b&c.ZOOM)e.zoom<this.minZoomLevel||e.zoom>this.maxZoomLevel?this.set("zoomLevel",
e.zoom):(a=this.zoomLevel,this.zoomLevel=e.zoom,a!==this.zoomLevel&&this.Fc("zoomLevel",this.zoomLevel,a));if(b&c.HEADING)a=this.heading,this.heading=e.heading,this.Fc("heading",this.heading,a);if(b&c.TILT)a=this.tilt,this.tilt=e.tilt,this.Fc("tilt",this.tilt,a)}this.zc=0},Hl:function(a,b,c){var e=this,f=h.now(),d=f-e.nl;if(a!==e.xb){e.zc|=b;e.Ke|=b;if(e.Fg){if(e.Fg&&d>25)e.Oj(a),e.Ae("",e.Ke),e.nl=f}else e.Ae("start",0),e.Oj(a),e.Ae("",e.Ke),e.nl=f,e.Fg=!0;if(c)e.Oj(a),e.Qj&&clearTimeout(e.Qj),e.Qj=
setTimeout(function(){e.Ke&&e.Ae("",e.Ke);e.Ae("end",0);e.Fg=!1;e.Qj=void 0},250)}},El:function(a,b){this.qaOnLoad&&b==="idle"&&this.qaOnLoad(this.zoomLevel);(this.xb||this.m)&&this.Gs(b)},tu:function(){if(this.Ie)this.Vc=void 0,this.L.finish(),this.Ie=!1},Gs:function(a){var b=this.m,c=this.xb;if(a==="error"){this.L.finish();this.Ie=!0;this.ma=this.m=this.xb=void 0;b.shutdown();if(c)this.Vc=c.getView(),c.shutdown();q.onError&&q.onError(this.Vc);this.onError&&this.onError(this.Vc);return!0}return!1},
Dl:function(a){var b=this,c=b.xb,e,f,d=b.Gk,g=b.L,h,k={old:b.nt,current:b.baseMapType};if(a!==b.xb){b.gr?(c&&c.setTransition(b.ma.TRANSITION.AUTO),a.setTransition(b.ma.TRANSITION.AUTO)):(c&&c.setTransition(b.ma.TRANSITION.NONE),a.setTransition(b.ma.TRANSITION.NONE));if(b.viewBounds)b.Gk=d=a.viewForBBox(b.viewBounds),delete b.viewBounds;if(c&&c.type==="panorama"&&!b.Vc)h=c.getCam(),d.latitude=h.latitude,d.longitude=h.longitude,d.altitude=c.convertAlt(d,"GL"),d.distance=void 0;b.Hk("start",k);a.loadDestinationCam(b.Gk,
function(d){var h;b.Cg.style.visibility="";if(c){e=h=g.getHandoverCam(a.type,c.type,d);f=b.Go?g.getDestinationCam(a.type,c.type,d):d;if(a.type==="panorama")h=ovi.extend({},e),e.altitude=d.altitude+52.8;a.setHandoverProperties(e);c.exit(h,function(){b.ms();a.enter(f,function(){b.L.finish();b.Go=!1;b.Hk("end",k)})})}else e=f=d,a.setHandoverProperties(e),a.enter(f,function(){b.Hk("end",k)});a.setPadding(b.padding.top,b.padding.right,b.padding.bottom,b.padding.left);b.bf(b.Cg.offsetWidth,b.Cg.offsetHeight)})}},
ms:function(){this.Cg.style.visibility="visible";this.Nd&&p.fd(this.Nd,0)},Zn:function(a){this.dispatch(new w({type:"transition"+a,target:this.kc,display:this}))},Hk:function(a,b){this.dispatch(new v({type:"basemapchange"+a,target:this.kc,display:this,baseMapData:b}));this.Ie&&a==="end"&&(this.tu(),this.dispatch(new x({type:"displayready",target:this.kc,display:this})))},update:function(a,b){this.m&&this.m.update(a<=0?!0:!1,b);return this},ot:function(a,b,c){var b=this.xs(c.pType),a=b[0],b=b[1],e=
b.view.zoom;this.set("maxZoomLevel",g(c.max,e.min,e.max));this.set("minZoomLevel",g(c.min,e.min,e.max));b.view&&(b.view.tilt&&(this.set("maxTilt",b.view.tilt.max||0),this.set("minTilt",b.view.tilt.min||0)),b.view.heading&&(this.set("maxHeading",b.view.heading.max||0),this.set("minHeading",b.view.heading.min||0)));this.ma=this.qu(a);c.lr(this.m);this.ma===a&&this.m.setMapProvider&&this.m.setMapProvider(c)},pan:function(a,b,c,e,f){var d=this.m;if(a-c||b-e)this.Ub(f),f=this.geoToPixel(this.center),a=
this.pixelToGeo(f.x+c-a,f.y+e-b),b=this.getView(),b.latitude=a.latitude,b.longitude=a.longitude,d.setView(b)},getCopyright:function(){var a=this.getViewBounds(),b=this.zoomLevel,c=[this.baseMapType].concat(this.overlays.asArray()),e=c.length,f=0,d=[];if(a)for(;f<e;f++)c[f].getCopyrights&&(d=d.concat(c[f].getCopyrights(a,b)));for(f=d.length;f--;)a=d[f].label,f!==0&&(a=a.replace(/[0-9]{4}[,\s]+/g," ")),d[f]=a;return d.join(", ")},beginControl:function(a,b,c,e){this.L.inProgress||this.m.beginControl(a,
b,c,e)},control:function(a,b,c,e,f,d,g,h){this.L.inProgress||this.m.control(a,b,c,e,f,d,g,h)},endControl:function(a){this.L.inProgress||this.m.endControl(a)},beginInteraction:function(a,b,c,e,f,d,g){this.L.inProgress||this.m.beginInteraction(a,b,c,e,f,d,g)},interact:function(a,b,c,e,f){this.L.inProgress||this.m.interact(a,b,c,e,f)},endInteraction:function(){this.L.inProgress||this.m.endInteraction()}}),y=e.Display.InteractionModifiers={ZOOM:l.ZOOM,HEADING:l.HEADING,TILT:l.TILT,INCLINE:l.INCLINE,COORD:l.COORD,
SIZE:l.SIZE};e.Display.prototype.InteractionModifiers={};h.flatMerge(e.Display.prototype.InteractionModifiers,y);h.flatMerge(e.Display,r.constants);h.flatMerge(e.Display.prototype,r.constants);var y=e.Display.MapViewChangeEvent=function(a){p.Event.call(this,a)},s={MAPVIEWCHANGE_ZOOM:l.ZOOM,MAPVIEWCHANGE_HEADING:l.HEADING,MAPVIEWCHANGE_TILT:l.TILT,MAPVIEWCHANGE_INCLINE:l.INCLINE,MAPVIEWCHANGE_CENTER:l.COORD,MAPVIEWCHANGE_SIZE:l.SIZE};h.flatMerge(y,s);s.data=0;h.flatMerge(y.prototype=new p.Event,s);
var u=e.Display.MapValueExceededEvent=function(a){p.Event.call(this,a)},w=e.Display.TransitionEvent=function(a){p.Event.call(this,a)},v=e.Display.BaseMapChangeEvent=function(a){p.Event.call(this,a)};v.baseMapData={old:void 0,current:void 0};v.prototype=new p.Event;var x=e.Display.DisplayReadyEvent=function(a){p.Event.call(this,a)};s.valueData={value:"",propertyName:"",min:null,max:null};u.prototype=new p.Event})(nokia.maps);ovi.provide("nokia.maps.map._packaging.package-render-display");})();
